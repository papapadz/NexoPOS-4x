/*! For license information please see pos-init.min.js.LICENSE.txt */
(self.webpackChunkNexoPOS_4x=self.webpackChunkNexoPOS_4x||[]).push([[443],{277:(t,e,r)=>{"use strict";r.d(e,{l:()=>H,kq:()=>et,ih:()=>M,kX:()=>K});var n=r(6486),i=r(9669),s=r(6300),o=r(8345),a=r(4085),u=r(9248),c=r(230);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function p(t){var e=function(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==l(e)?e:String(e)}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._subject=new u.x}var e,r,n;return e=t,r=[{key:"defineClient",value:function(t){this._client=t}},{key:"post",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._request("post",t,e,r)}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._request("get",t,void 0,e)}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._request("delete",t,void 0,e)}},{key:"put",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._request("put",t,e,r)}},{key:"response",get:function(){return this._lastRequestData}},{key:"_request",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return e=et.applyFilters("http-client-url",e.replace(/\/$/,"")),this._subject.next({identifier:"async.start",url:e,data:n}),new c.y((function(s){r._client[t](e,n,Object.assign(Object.assign({},r._client.defaults[t]),i)).then((function(t){r._lastRequestData=t,s.next(t.data),s.complete(),r._subject.next({identifier:"async.stop"})})).catch((function(t){var e;s.error((null===(e=t.response)||void 0===e?void 0:e.data)||t.response||t),r._subject.next({identifier:"async.stop"})}))}))}},{key:"subject",value:function(){return this._subject}},{key:"emit",value:function(t){var e=t.identifier,r=t.value;this._subject.next({identifier:e,value:r})}}],r&&d(e.prototype,r),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),h=r(3);function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y(n.key),n)}}function y(t){var e=function(t,e){if("object"!=v(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==v(e)?e:String(e)}var _=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._subject=new h.t}var e,r,n;return e=t,(r=[{key:"subject",value:function(){return this._subject}},{key:"emit",value:function(t){var e=t.identifier,r=t.value;this._subject.next({identifier:e,value:r})}}])&&m(e.prototype,r),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),b=r(6515);function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,x(n.key),n)}}function x(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==g(e)?e:String(e)}var C=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state={},this.behaviorState=new b.X({}),this.behaviorState.subscribe((function(t){r.state=t})),this.setState(e)}var e,r,n;return e=t,(r=[{key:"setState",value:function(t){this.behaviorState.next(Object.assign(Object.assign({},this.state),{object:t}))}}])&&w(e.prototype,r),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),k=r(2401),j=r(8272),P=r(381),S=r(2285),O=r(538),E=r(40);function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$(n.key),n)}}function $(t){var e=function(t,e){if("object"!=T(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==T(e)?e:String(e)}var V=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=ns.base_url}var e,r,n;return e=t,(r=[{key:"get",value:function(t){return this.url+t}}])&&L(e.prototype,r),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),A=O.default.filter("abbreviate",(function(t){var e=t;if(t>=1e3){for(var r,n=Math.floor((""+t).length/3),i=2;i>=1;i--){if(((r=parseFloat((0!=n?t/Math.pow(1e3,n):t).toPrecision(i)))+"").replace(/[^a-zA-Z 0-9]+/g,"").length<=2)break}r%1!=0&&(r=r.toFixed(1)),e=r+["","k","m","b","t"][n]}return e})),F=r(6261),N=r(7761);function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function q(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,R(n.key),n)}}function R(t){var e=function(t,e){if("object"!=Z(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Z(e)?e:String(e)}var I=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instances=new Object}var e,r,n;return e=t,(r=[{key:"getInstance",value:function(t){return this.instances[t]}},{key:"defineInstance",value:function(t,e){this.instances[t]=e}}])&&q(e.prototype,r),n&&q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),G=r(2319),z=r(9165),X=r(4914),Q=r(4503),U=r(4554);function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function D(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B(n.key),n)}}function B(t){var e=function(t,e){if("object"!=W(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==W(e)?e:String(e)}var Y=r(6606);window._=n,window.ChartJS=s,window.Pusher=Y,window.Vue=O.default,window.moment=P,window.Axios=i,window.__=z.__,window.__m=z.c,window.VueRouter=o.ZP,window.SnackBar=a.S,window.nsHooks=(0,G.Hu)(),window.popupResolver=X.Z,window.popupCloser=Q.Z,window.Axios.defaults.headers.common["x-requested-with"]="XMLHttpRequest",window.Axios.defaults.withCredentials=!0,ns.websocket.enabled&&(window.Echo=new U.ZP({broadcaster:"pusher",key:ns.websocket.key,wsHost:ns.websocket.host,wsPort:ns.websocket.port,wssPort:ns.websocket.port,namespace:"",forceTLS:ns.websocket.secured,disableStats:!0,encrypted:ns.websocket.secured,enabledTransports:ns.websocket.secured?["ws","wss"]:["ws"],disabledTransports:ns.websocket.secured?["sockjs","xhr_polling","xhr_streaming"]:[]}));var H=new _,M=new f,K=new a.S,J=new V,tt=new I,et=window.nsHooks,rt=new(function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.breakpoint="",this.detectScreenSizes(),(0,k.R)(window,"resize").subscribe((function(t){return e.detectScreenSizes()}))}var e,r,n;return e=t,(r=[{key:"detectScreenSizes",value:function(){switch(!0){case window.outerWidth>0&&window.outerWidth<=480:this.breakpoint="xs";break;case window.outerWidth>480&&window.outerWidth<=640:this.breakpoint="sm";break;case window.outerWidth>640&&window.outerWidth<=1024:this.breakpoint="md";break;case window.outerWidth>1024&&window.outerWidth<=1280:this.breakpoint="lg";break;case window.outerWidth>1280:this.breakpoint="xl"}}}])&&D(e.prototype,r),n&&D(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()),nt=new C({sidebar:["xs","sm","md"].includes(rt.breakpoint)?"hidden":"visible"});M.defineClient(i),window.nsEvent=H,window.nsHttpClient=M,window.nsSnackBar=K,window.nsCurrency=F.W,window.nsTruncate=N.b,window.nsRawCurrency=F.f,window.nsAbbreviate=A,window.nsState=nt,window.nsUrl=J,window.nsScreen=rt,window.ChartJS=s,window.EventEmitter=_,window.Popup=S.G,window.RxJS=j,window.FormValidation=E.Z,window.nsCrudHandler=tt},6261:(t,e,r)=>{"use strict";r.d(e,{W:()=>c,f:()=>l});var n=r(538),i=r(2077),s=r.n(i),o=r(6740),a=r.n(o),u=new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(t){return 0})).join(""),c=n.default.filter("currency",(function(t){var e,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"full";switch(ns.currency.ns_currency_prefered){case"iso":e=ns.currency.ns_currency_iso;break;case"symbol":e=ns.currency.ns_currency_symbol}if("full"===n){var i={decimal:ns.currency.ns_currency_decimal_separator,separator:ns.currency.ns_currency_thousand_separator,precision:parseInt(ns.currency.ns_currency_precision),symbol:""};r=a()(t,i).format()}else r=s()(t).format("0.0a");return"".concat("before"===ns.currency.ns_currency_position?e:"").concat(r).concat("after"===ns.currency.ns_currency_position?e:"")})),l=function(t){var e="0.".concat(u);return parseFloat(s()(t).format(e))}},7761:(t,e,r)=>{"use strict";r.d(e,{b:()=>n});var n=r(538).default.filter("truncate",(function(t,e){return t?(t=t.toString()).length>e?t.substring(0,e)+"...":t:""}))},40:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function s(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:String(e)}r.d(e,{Z:()=>o});var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,r=[{key:"validateFields",value:function(t){var e=this;return 0===t.map((function(t){return e.checkField(t),t.errors?0===t.errors.length:0})).filter((function(t){return!1===t})).length}},{key:"validateFieldsErrors",value:function(t){var e=this;return t.map((function(t){return e.checkField(t),t.errors})).flat()}},{key:"validateForm",value:function(t){t.main&&this.validateField(t.main);var e=[];for(var r in t.tabs){var n=[],i=this.validateFieldsErrors(t.tabs[r].fields);i.length>0&&n.push(i),t.tabs[r].errors=n.flat(),e.push(n.flat())}return e.flat().filter((function(t){return void 0!==t}))}},{key:"initializeTabs",value:function(t){var e=0;for(var r in t)0===e&&(t[r].active=!0),t[r].active=void 0!==t[r].active&&t[r].active,t[r].fields=this.createFields(t[r].fields),e++;return t}},{key:"validateField",value:function(t){return this.checkField(t)}},{key:"fieldsValid",value:function(t){return!(t.map((function(t){return t.errors&&t.errors.length>0})).filter((function(t){return t})).length>0)}},{key:"createFields",value:function(t){return t.map((function(t){return t.type=t.type||"text",t.errors=t.errors||[],t.disabled=t.disabled||!1,"custom"===t.type&&(t.component=nsExtraComponents[t.name]),t}))}},{key:"createForm",value:function(t){if(t.main&&(t.main=this.createFields([t.main])[0]),t.tabs)for(var e in t.tabs)t.tabs[e].fields=this.createFields(t.tabs[e].fields),t.tabs[e].errors=[];return t}},{key:"enableFields",value:function(t){return t.map((function(t){return t.disabled=!1}))}},{key:"disableFields",value:function(t){return t.map((function(t){return t.disabled=!0}))}},{key:"disableForm",value:function(t){for(var e in t.main&&(t.main.disabled=!0),t.tabs)t.tabs[e].fields.forEach((function(t){return t.disabled=!0}))}},{key:"enableForm",value:function(t){for(var e in t.main&&(t.main.disabled=!1),t.tabs)t.tabs[e].fields.forEach((function(t){return t.disabled=!1}))}},{key:"getValue",value:function(t){var e={};return t.forEach((function(t){e[t.name]=t.value})),e}},{key:"checkField",value:function(t){var e=this;return void 0!==t.validation&&(t.errors=[],this.detectValidationRules(t.validation).forEach((function(r){e.fieldPassCheck(t,r)}))),t}},{key:"extractForm",value:function(t){var e={};if(t.main&&(e[t.main.name]=t.main.value),t.tabs)for(var r in t.tabs)void 0===e[r]&&(e[r]={}),e[r]=this.extractFields(t.tabs[r].fields);return e}},{key:"extractFields",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.forEach((function(t){e[t.name]=t.value})),e}},{key:"detectValidationRules",value:function(t){var e=function(t){var e;return["email","required"].includes(t)?{identifier:t}:(e=/(min)\:([0-9])+/g.exec(t))||(e=/(max)\:([0-9])+/g.exec(t))?{identifier:e[1],value:e[2]}:t};return Array.isArray(t)?t.filter((function(t){return"string"==typeof t})).map(e):t.split("|").map(e)}},{key:"triggerError",value:function(t,e){if(e.errors){var r=function(r){var n=r.split(".").filter((function(t){return!/^\d+$/.test(t)}));2===n.length&&t.tabs[n[0]].fields.forEach((function(t){t.name===n[1]&&e.errors[r].forEach((function(e){var r={identifier:"invalid",invalid:!0,message:e,name:t.name};t.errors.push(r)}))})),r===t.main.name&&e.errors[r].forEach((function(e){t.main.errors.push({identifier:"invalid",invalid:!0,message:e,name:t.main.name})}))};for(var n in e.errors)r(n)}}},{key:"triggerFieldsErrors",value:function(t,e){if(e&&e.errors){var r=function(r){t.forEach((function(t){t.name===r&&e.errors[r].forEach((function(e){var r={identifier:"invalid",invalid:!0,message:e,name:t.name};t.errors.push(r)}))}))};for(var n in e.errors)r(n)}}},{key:"fieldPassCheck",value:function(t,e){if("required"===e.identifier){if(void 0===t.value||null===t.value||0===t.value.length)return t.errors.push({identifier:e.identifier,invalid:!0,name:t.name});t.errors.forEach((function(r,n){r.identifier===e.identifier&&!0===r.invalid&&t.errors.splice(n,1)}))}if("email"===e.identifier&&t.value.length>0){if(!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/.test(t.value))return t.errors.push({identifier:e.identifier,invalid:!0,name:t.name});t.errors.forEach((function(r,n){!0===r[e.identifier]&&t.errors.splice(n,1)}))}return t}}],r&&i(e.prototype,r),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},9165:(t,e,r)=>{"use strict";r.d(e,{__:()=>n,c:()=>i});var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NexoPOS";return nsLanguage.getEntries(e)&&nsLanguage.getEntries(e)[t]||t},i=function(t,e){return nsLanguage.getEntries(e)&&nsLanguage.getEntries(e)[t]||t}},4503:(t,e,r)=>{"use strict";function n(){var t=this;Object.keys(this).includes("$popup")&&this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&(t.$popupParams&&void 0!==t.$popupParams.reject&&t.$popupParams.reject(!1),t.$popup.close()),"press-esc"===e.event&&(t.$popupParams&&void 0!==t.$popupParams.reject&&t.$popupParams.reject(!1),t.$popup.close())}))}r.d(e,{Z:()=>n})},4914:(t,e,r)=>{"use strict";function n(t){void 0!==this.$popupParams.resolve&&this.$popupParams.reject&&(!1!==t?this.$popupParams.resolve(t):this.$popupParams.reject(t)),this.$popup.close()}r.d(e,{Z:()=>n})},2285:(t,e,r)=>{"use strict";r.d(e,{G:()=>a});var n=r(9248);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o(n.key),n)}}function o(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:String(e)}var a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config={primarySelector:void 0,popupClass:"shadow-lg h-half w-1/2 bg-white"},this.container=document.createElement("div"),this.popupBody=document.createElement("div"),this.config=Object.assign(this.config,e),void 0===this.config.primarySelector&&document.querySelectorAll(".is-popup").length>0){var r=document.querySelectorAll(".is-popup").length;this.parentWrapper=document.querySelectorAll(".is-popup")[r-1]}else this.parentWrapper=document.querySelector("body").querySelectorAll("div")[0];this.event=new n.x}var e,r,i;return e=t,r=[{key:"open",value:function(t){var e,r,n,i=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=document.querySelector("body").querySelectorAll("div")[0];this.parentWrapper.style.filter="blur(4px)",o.style.filter="blur(6px)",this.container.setAttribute("class","absolute top-0 left-0 w-full h-full flex items-center justify-center is-popup"),this.container.addEventListener("click",(function(t){i.event.next({event:"click-overlay",value:!0}),t.stopPropagation()})),this.popupBody.addEventListener("click",(function(t){t.stopImmediatePropagation()})),this.container.style.background="rgb(51 51 51 / 20%)",this.container.id="popup-container-"+document.querySelectorAll(".is-popup").length,this.popupBody.setAttribute("class"," zoom-out-entrance"),this.popupBody.innerHTML='<div class="popup-body"></div>',this.container.appendChild(this.popupBody),document.body.appendChild(this.container);var a=Vue.extend(t);this.instance=new a({propsData:{popup:this}}),this.instance.template=(null===(e=null==t?void 0:t.options)||void 0===e?void 0:e.template)||void 0,this.instance.render=t.render||void 0,this.instance.methods=(null===(r=null==t?void 0:t.options)||void 0===r?void 0:r.methods)||(null==t?void 0:t.methods),this.instance.data=(null===(n=null==t?void 0:t.options)||void 0===n?void 0:n.data)||(null==t?void 0:t.data),this.instance.$popup=this,this.instance.$popupParams=s,this.instance.$mount("#".concat(this.container.id," .popup-body"))}},{key:"close",value:function(){var t=this;this.instance.$destroy(),this.event.unsubscribe(),this.parentWrapper.style.filter="blur(0px)";var e=document.querySelector("body").querySelectorAll("div")[0];document.querySelectorAll(".is-popup").length<=1&&(e.style.filter="blur(0px)"),this.popupBody.classList.remove("zoom-out-entrance"),this.popupBody.classList.add("zoom-in-exit"),this.container.classList.remove("is-popup"),setTimeout((function(){t.container.remove()}),300)}}],i=[{key:"show",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new t(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{});return n.open(e,r),n}}],r&&s(e.prototype,r),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}()},4085:(t,e,r)=>{"use strict";r.d(e,{S:()=>a});var n=r(3260);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o(n.key),n)}}function o(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:String(e)}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),void 0===window.snackbarQueue&&(window.snackbarQueue=[],this.queue=window.snackbarQueue)}var e,r,i;return e=t,r=[{key:"show",value:function(t,e){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"info"};return n.Observable.create((function(n){var s=r.__createSnack({message:t,label:e,type:i.type}),o=s.buttonNode,a=(s.textNode,s.snackWrapper,s.sampleSnack);o.addEventListener("click",(function(t){n.onNext(o),n.onCompleted(),a.remove()})),r.__startTimer(i.duration,a)}))}},{key:"error",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"error"};return this.show(t,e,Object.assign(Object.assign({},r),{type:"error"}))}},{key:"success",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"success"};return this.show(t,e,Object.assign(Object.assign({},r),{type:"success"}))}},{key:"info",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{duration:3e3,type:"info"};return this.show(t,e,Object.assign(Object.assign({},r),{type:"info"}))}},{key:"__startTimer",value:function(t,e){var r,n=function(){t>0&&!1!==t&&(r=setTimeout((function(){e.remove()}),t))};e.addEventListener("mouseenter",(function(){clearTimeout(r)})),e.addEventListener("mouseleave",(function(){n()})),n()}},{key:"__createSnack",value:function(t){var e=t.message,r=t.label,n=t.type,i=void 0===n?"info":n,s=document.getElementById("snack-wrapper")||document.createElement("div"),o=document.createElement("div"),a=document.createElement("p"),u=document.createElement("div"),c=document.createElement("button"),l="",d="";switch(i){case"info":l="text-white hover:bg-blue-400 bg-blue-500",d="bg-gray-900 text-white";break;case"error":l="text-red-700 hover:bg-white bg-white",d="bg-red-500 text-white";break;case"success":l="text-green-700 hover:bg-white bg-white",d="bg-green-500 text-white"}return a.textContent=e,r&&(c.textContent=r,c.setAttribute("class","px-3 py-2 shadow rounded uppercase ".concat(l)),u.appendChild(c)),o.appendChild(a),o.appendChild(u),o.setAttribute("class","md:rounded py-2 px-3 md:w-2/5 w-full z-10 md:my-2 shadow-lg flex justify-between items-center zoom-in-entrance anim-duration-300 ".concat(d)),s.appendChild(o),null===document.getElementById("snack-wrapper")&&(s.setAttribute("id","snack-wrapper"),s.setAttribute("class","absolute bottom-0 w-full flex justify-between items-center flex-col"),document.body.appendChild(s)),{snackWrapper:s,sampleSnack:o,buttonsWrapper:u,buttonNode:c,textNode:a}}}],r&&s(e.prototype,r),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}()},3612:(t,e,r)=>{"use strict";r.d(e,{$:()=>l});var n=r(277),i=r(9165),s=r(2285),o=r(1836);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function c(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==a(e)?e:String(e)}var l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.product=e}var e,r,a;return e=t,(r=[{key:"run",value:function(t){var e=this;return new Promise((function(r,a){var u=new s.G({popupClass:"shadow-lg h-1/2-screen w-3/4 md:w-1/2 lg:w-2/5 xl:w-1/4 bg-white"}),c=e.product;if(!1===POS.options.getValue().ns_pos_show_quantity&&POS.processingAddQueue){if("enabled"===c.$original().stock_management){var l=POS.getStockUsage(c.$original().id,t.unit_quantity_id)-(c.quantity||0);if(1>parseFloat(t.$quantities().quantity)-l)return n.kX.error((0,i.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",(t.$quantities().quantity-l).toString())).subscribe()}r({quantity:1})}else u.open(o.Z,{resolve:r,reject:a,product:c,data:t})}))}}])&&u(e.prototype,r),a&&u(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}()},811:(t,e,r)=>{"use strict";var n=r(3612),i=r(2285),s=r(277),o=r(9165);const a={data:function(){return{unitsQuantities:[],loadsUnits:!1,options:null,optionsSubscriber:null}},beforeDestroy:function(){this.optionsSubscriber.unsubscribe()},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&(t.$popupParams.reject(!1),t.$popup.close())})),this.optionsSubscriber=POS.options.subscribe((function(e){t.options=e})),void 0!==this.$popupParams.product.$original().selectedUnitQuantity?this.selectUnit(this.$popupParams.product.$original().selectedUnitQuantity):void 0!==this.$popupParams.product.$original().unit_quantities&&1===this.$popupParams.product.$original().unit_quantities.length?this.selectUnit(this.$popupParams.product.$original().unit_quantities[0]):(this.loadsUnits=!0,this.loadUnits())},methods:{__:o.__,displayRightPrice:function(t){return POS.getSalePrice(t,this.$popupParams.product.$original())},loadUnits:function(){var t=this;s.ih.get("/api/nexopos/v4/products/".concat(this.$popupParams.product.$original().id,"/units/quantities")).subscribe((function(e){if(0===e.length)return t.$popup.close(),s.kX.error((0,o.__)("This product doesn't have any unit defined for selling.")).subscribe();t.unitsQuantities=e,1===t.unitsQuantities.length&&t.selectUnit(t.unitsQuantities[0])}))},selectUnit:function(t){this.$popupParams.resolve({unit_quantity_id:t.id,unit_name:t.unit.name,$quantities:function(){return t}}),this.$popup.close()}}};const u=(0,r(1900).Z)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"h-full w-full flex items-center justify-center"},[t.unitsQuantities.length>0?e("div",{staticClass:"bg-white w-2/3-screen lg:w-1/3-screen overflow-hidden flex flex-col"},[e("div",{staticClass:"h-16 flex justify-center items-center flex-shrink-0",attrs:{id:"header"}},[e("h3",{staticClass:"font-bold text-gray-700"},[t._v(t._s(t.__("Choose Selling Unit")))])]),t._v(" "),t.unitsQuantities.length>0?e("div",{staticClass:"grid grid-flow-row grid-cols-2 overflow-y-auto"},t._l(t.unitsQuantities,(function(r){return e("div",{key:r.id,staticClass:"hover:bg-gray-200 cursor-pointer border flex-shrink-0 border-gray-200 flex flex-col items-center justify-center",on:{click:function(e){return t.selectUnit(r)}}},[e("div",{staticClass:"h-40 w-full flex items-center justify-center overflow-hidden"},[r.preview_url?e("img",{staticClass:"object-cover h-full",attrs:{src:r.preview_url,alt:r.unit.name}}):t._e(),t._v(" "),r.preview_url?t._e():e("div",{staticClass:"h-40 flex items-center justify-center"},[e("i",{staticClass:"las la-image text-gray-600 text-6xl"})])]),t._v(" "),e("div",{staticClass:"h-0 w-full"},[e("div",{staticClass:"relative w-full flex items-center justify-center -top-10 h-20 py-2 flex-col",staticStyle:{background:"rgb(255 255 255 / 73%)"}},[e("h3",{staticClass:"font-bold text-gray-700 py-2 text-center"},[t._v(t._s(r.unit.name)+" ("+t._s(r.quantity)+")")]),t._v(" "),e("p",{staticClass:"text-sm font-medium text-gray-600"},[t._v(t._s(t._f("currency")(t.displayRightPrice(r))))])])])])})),0):t._e()]):t._e(),t._v(" "),0===t.unitsQuantities.length?e("div",{staticClass:"h-56 flex items-center justify-center"},[e("ns-spinner")],1):t._e()])}),[],!1,null,null,null).exports;function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d(n.key),n)}}function d(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:String(e)}var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.product=e}var e,r,n;return e=t,(r=[{key:"run",value:function(){var t=this;return new Promise((function(e,r){var n=new i.G({popupClass:"shadow-lg h-1/2-screen w-3/4 xl:w-1/4 bg-white"}),s=t.product;n.open(u,{resolve:e,reject:r,product:s})}))}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),f=r(6515),h=r(538);function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y(n.key),n)}}function y(t){var e=function(t,e){if("object"!=v(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==v(e)?e:String(e)}var _=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.detect()}var e,r,n;return e=t,(r=[{key:"detect",value:function(){window.innerWidth<544?this.screenIs="xs":window.innerWidth>=544&&window.innerWidth<768?this.screenIs="sm":window.innerWidth>=768&&window.innerWidth<992?this.screenIs="md":window.innerWidth>=992&&window.innerWidth<1200?this.screenIs="lg":window.innerWidth>=1200&&(this.screenIs="xl")}},{key:"is",value:function(t){return void 0===t?this.screenIs:this.screenIs===t}}])&&m(e.prototype,r),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),b=r(381),g=r.n(b);function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function x(){x=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var s=e&&e.prototype instanceof y?e:y,o=Object.create(s.prototype),a=new $(n||[]);return i(o,"_invoke",{value:O(t,r,a)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",f="suspendedYield",h="executing",v="completed",m={};function y(){}function _(){}function b(){}var g={};c(g,o,(function(){return this}));var C=Object.getPrototypeOf,k=C&&C(C(V([])));k&&k!==r&&n.call(k,o)&&(g=k);var j=b.prototype=y.prototype=Object.create(g);function P(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(i,s,o,a){var u=d(t[i],t,s);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==w(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,o,a)}),(function(t){r("throw",t,o,a)})):e.resolve(l).then((function(t){c.value=t,o(c)}),(function(t){return r("throw",t,o,a)}))}a(u.arg)}var s;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return s=s?s.then(i,i):i()}})}function O(e,r,n){var i=p;return function(s,o){if(i===h)throw new Error("Generator is already running");if(i===v){if("throw"===s)throw o;return{value:t,done:!0}}for(n.method=s,n.arg=o;;){var a=n.delegate;if(a){var u=E(a,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var c=d(e,r,n);if("normal"===c.type){if(i=n.done?v:f,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=v,n.method="throw",n.arg=c.arg)}}}function E(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var s=d(i,e.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,m;var o=s.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function $(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function V(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(w(e)+" is not iterable")}return _.prototype=b,i(j,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},P(S.prototype),c(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,i,s){void 0===s&&(s=Promise);var o=new S(l(t,r,n,i),s);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},P(j),c(j,u,"Generator"),c(j,o,(function(){return this})),c(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=V,$.prototype={constructor:$,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:V(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function C(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k(n.key),n)}}function k(t){var e=function(t,e){if("object"!=w(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==w(e)?e:String(e)}var j=function(t,e,r,n){return new(r||(r=Promise))((function(i,s){function o(t){try{u(n.next(t))}catch(t){s(t)}}function a(t){try{u(n.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}u((n=n.apply(t,e||[])).next())}))},P=window.NsPosDashboardButton=r(8867).Z,S=window.NsPosPendingOrderButton=r(8741).Z,O=window.NsPosOrderTypeButton=r(1159).Z,E=window.NsPosCustomersButton=r(6442).Z,T=window.NsPosResetButton=r(5405).Z,L=window.NsPosCashRegister=r(2445).Z,$=window.NsAlertPopup=r(8682).Z,V=window.NsConfirmPopup=r(7995).Z,A=(window.NsPOSLoadingPopup=r(8674).Z,window.NsPromptPopup=r(149).Z),F=window.NsLayawayPopup=r(3866).Z,N=window.NsLayawayPopup=r(1294).Z,Z=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._orderTypeProcessQueue=[],this._holdPopupEnabled=!0,this._initialQueue=[],this._responsive=new _,this._isSubmitting=!1,this._processingAddQueue=!1,this.defaultOrder=function(){return{discount_type:null,title:"",discount:0,register_id:e.get("register")?e.get("register").id:void 0,discount_percentage:0,subtotal:0,total:0,coupons:[],total_coupons:0,tendered:0,note:"",note_visibility:"hidden",tax_group_id:void 0,tax_type:void 0,taxes:[],tax_groups:[],payment_status:void 0,customer_id:void 0,change:0,total_products:0,shipping:0,tax_value:0,product_taxes:0,shipping_rate:0,shipping_type:void 0,customer:void 0,type:void 0,products:[],instalments:[],payments:[],addresses:{shipping:void 0,billing:void 0}}},this.addToCartQueue=[p,n.$],this.initialize()}var e,r,a;return e=t,r=[{key:"screen",get:function(){return this._screen}},{key:"visibleSection",get:function(){return this._visibleSection}},{key:"paymentsType",get:function(){return this._paymentsType}},{key:"selectedPaymentType",get:function(){return this._selectedPaymentType}},{key:"order",get:function(){return this._order}},{key:"types",get:function(){return this._types}},{key:"products",get:function(){return this._products}},{key:"customers",get:function(){return this._customers}},{key:"options",get:function(){return this._options}},{key:"orderTypeQueue",get:function(){return this._orderTypeProcessQueue}},{key:"settings",get:function(){return this._settings}},{key:"breadcrumbs",get:function(){return this._breadcrumbs}},{key:"initialQueue",get:function(){return this._initialQueue}},{key:"responsive",get:function(){return this._responsive}},{key:"processingAddQueue",get:function(){return this._processingAddQueue}},{key:"reset",value:function(){this._isSubmitting=!1,this.order.next(this.defaultOrder()),this._products.next([]),this._customers.next([]),this._breadcrumbs.next([]),this.defineCurrentScreen(),this.setHoldPopupEnabled(!0),this.processInitialQueue(),this.refreshCart()}},{key:"initialize",value:function(){var t=this;this._products=new f.X([]),this._customers=new f.X([]),this._types=new f.X([]),this._breadcrumbs=new f.X([]),this._screen=new f.X(""),this._paymentsType=new f.X([]),this._visibleSection=new f.X("both"),this._options=new f.X({}),this._settings=new f.X({}),this._order=new f.X(this.defaultOrder()),this._selectedPaymentType=new f.X(null),this._orderTypeProcessQueue=[{identifier:"handle.delivery-order",promise:function(t){return new Promise((function(e,r){return t&&"delivery"===t.identifier?i.G.show(N,{resolve:e,reject:r}):e({status:"success",message:"Proceed"})}))}}],this.initialQueue.push((function(){return new Promise((function(e,r){var n=t.options.getValue(),i=t.order.getValue();return!1!==n.ns_pos_tax_group&&(i.tax_group_id=n.ns_pos_tax_group,i.tax_type=n.ns_pos_tax_type,t.order.next(i)),e({status:"success",message:"tax group assignated"})}))})),this.initialQueue.push((function(){return new Promise((function(e,r){var n=t.options.getValue();return t.order.getValue(),!1!==n.ns_customers_default&&s.ih.get("/api/nexopos/v4/customers/".concat(n.ns_customers_default)).subscribe({next:function(r){t.selectCustomer(r),e({status:"success",message:(0,o.__)("The customer has been loaded")})},error:function(t){s.kX.error((0,o.__)("Unable to select the default customer. Looks like the customer no longer exists. Consider changing the default customer on the settings."),(0,o.__)("OKAY"),{duration:0}).subscribe(),r(t)}}),e({status:"success",message:"tax group assignated"})}))})),this.products.subscribe((function(e){t.refreshCart()})),this.types.subscribe((function(e){var r=Object.values(e).filter((function(t){return t.selected}));if(r.length>0){var n=t.order.getValue();n.type=r[0],t.order.next(n)}})),window.addEventListener("resize",(function(){t._responsive.detect(),t.defineCurrentScreen()})),window.onbeforeunload=function(){if(t.products.getValue().length>0)return(0,o.__)("Some products has been added to the cart. Would youl ike to discard this order ?")},this.defineCurrentScreen()}},{key:"getSalePrice",value:function(t,e){return"inclusive"===e.tax_type?t.incl_tax_sale_price:t.excl_tax_sale_price}},{key:"getCustomPrice",value:function(t,e){return"inclusive"===e.tax_type?t.incl_tax_custom_price:t.excl_tax_custom_price}},{key:"getWholesalePrice",value:function(t,e){return"inclusive"===e.tax_type?t.incl_tax_wholesale_price:t.excl_tax_wholesale_price}},{key:"setHoldPopupEnabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._holdPopupEnabled=t}},{key:"getHoldPopupEnabled",value:function(){return this._holdPopupEnabled}},{key:"processInitialQueue",value:function(){return j(this,void 0,void 0,x().mark((function t(){var e;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=x().keys(this._initialQueue);case 1:if((t.t1=t.t0()).done){t.next=14;break}return e=t.t1.value,t.prev=3,t.next=6,this._initialQueue[e]();case 6:t.sent,t.next=12;break;case 9:t.prev=9,t.t2=t.catch(3),s.kX.error(t.t2.message).subscribe();case 12:t.next=1;break;case 14:case"end":return t.stop()}}),t,this,[[3,9]])})))}},{key:"removeCoupon",value:function(t){var e=this.order.getValue(),r=e.coupons,n=r.indexOf(t);r.splice(n,1),e.coupons=r,this.order.next(e)}},{key:"pushCoupon",value:function(t){var e=this.order.getValue();e.coupons.forEach((function(e){if(e.code===t.code){var r=(0,o.__)("This coupon is already added to the cart");throw s.kX.error(r).subscribe(),r}})),e.coupons.push(t),this.order.next(e),this.refreshCart()}},{key:"header",get:function(){var t={buttons:{NsPosDashboardButton:P,NsPosPendingOrderButton:S,NsPosOrderTypeButton:O,NsPosCustomersButton:E,NsPosResetButton:T}};return"yes"===this.options.getValue().ns_pos_registers_enabled&&(t.buttons.NsPosCashRegister=L),s.kq.doAction("ns-pos-header",t),t}},{key:"defineOptions",value:function(t){this._options.next(t)}},{key:"defineCurrentScreen",value:function(){this._visibleSection.next(["xs","sm"].includes(this._responsive.is())?"grid":"both"),this._screen.next(this._responsive.is())}},{key:"changeVisibleSection",value:function(t){["both","cart","grid"].includes(t)&&(["cart","both"].includes(t)&&this.refreshCart(),this._visibleSection.next(t))}},{key:"addPayment",value:function(t){if(t.value>0){var e=this._order.getValue();return e.payments.push(t),this._order.next(e),this.computePaid()}return s.kX.error("Invalid amount.").subscribe()}},{key:"removePayment",value:function(t){if(void 0!==t.id)return s.kX.error("Unable to delete a payment attached to the order").subscribe();var e=this._order.getValue(),r=e.payments.indexOf(t);e.payments.splice(r,1),this._order.next(e),s.l.emit({identifier:"ns.pos.remove-payment",value:t}),this.updateCustomerAccount(t),this.computePaid()}},{key:"updateCustomerAccount",value:function(t){if("account-payment"===t.identifier){var e=this.order.getValue().customer;e.account_amount+=t.value,this.selectCustomer(e)}}},{key:"getNetPrice",value:function(t,e,r){return"inclusive"===r?t/(e+100)*100:"exclusive"===r?t/100*(e+100):void 0}},{key:"getVatValue",value:function(t,e,r){return"inclusive"===r?t-this.getNetPrice(t,e,r):"exclusive"===r?this.getNetPrice(t,e,r)-t:void 0}},{key:"computeTaxes",value:function(){var t=this;return new Promise((function(e,r){var n=t.order.getValue();if(void 0===(n=t.computeProductsTaxes(n)).tax_group_id||null===n.tax_group_id)return r(!1);var i=n.tax_groups;return i&&void 0!==i[n.tax_group_id]?(n.taxes=n.taxes.map((function(e){return e.tax_value=t.getVatValue(n.subtotal,e.rate,n.tax_type),e})),n=t.computeOrderTaxes(n),e({status:"success",data:{tax:i[n.tax_group_id],order:n}})):null!==n.tax_group_id&&n.tax_group_id.toString().length>0?void s.ih.get("/api/nexopos/v4/taxes/groups/".concat(n.tax_group_id)).subscribe({next:function(r){return n.tax_groups=n.tax_groups||[],n.taxes=r.taxes.map((function(e){return{tax_id:e.id,tax_name:e.name,rate:parseFloat(e.rate),tax_value:t.getVatValue(n.subtotal,e.rate,n.tax_type)}})),n.tax_groups[r.id]=r,n=t.computeOrderTaxes(n),e({status:"success",data:{tax:r,order:n}})},error:function(t){return r(t)}}):r({status:"failed",message:(0,o.__)("No tax group assigned to the order")})}))}},{key:"computeOrderTaxes",value:function(t){var e=this.options.getValue().ns_pos_vat;return["flat_vat","variable_vat","products_variable_vat"].includes(e)&&t.taxes&&t.taxes.length>0&&(t.tax_value+=t.taxes.map((function(t){return t.tax_value})).reduce((function(t,e){return t+e}))),t.tax_value+=t.product_taxes,t}},{key:"computeProductsTaxes",value:function(t){var e=this.products.getValue(),r=e.map((function(t){return t.tax_value}));t.product_taxes=0;var n=this.options.getValue().ns_pos_vat;return["products_vat","products_flat_vat","products_variable_vat"].includes(n)&&r.length>0&&(t.product_taxes+=r.reduce((function(t,e){return t+e}))),t.products=e,t.total_products=e.length,t}},{key:"canProceedAsLaidAway",value:function(t){var e=this;return new Promise((function(r,n){return j(e,void 0,void 0,x().mark((function e(){var s,a,u,c,l,d,p,f=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.customer.group.minimal_credit_payment,a=(t.total*s/100).toFixed(ns.currency.ns_currency_precision),a=parseFloat(a),e.prev=3,e.next=6,new Promise((function(e,r){i.G.show(F,{order:t,reject:r,resolve:e})}));case 6:if(!(0===(u=e.sent).instalments.length&&u.tendered<a)){e.next=13;break}return c=(0,o.__)("Before saving the order as laid away, a minimum payment of {amount} is required").replace("{amount}",h.default.filter("currency")(a)),i.G.show($,{title:(0,o.__)("Unable to proceed"),message:c}),e.abrupt("return",n({status:"failed",message:c}));case 13:if(l=this.selectedPaymentType.getValue(),0!==(d=u.instalments.filter((function(t){return t.amount>=a&&g()(t.date).isSame(ns.date.moment.startOf("day"),"day")}))).length){e.next=17;break}return e.abrupt("return",r({status:"success",message:(0,o.__)("Layaway defined"),data:{order:u}}));case 17:p=d[0].amount,i.G.show(V,{title:(0,o.__)("Confirm Payment"),message:(0,o.__)('An instalment has been detected. Would you like to add as first payment {amount} for the selected payment type "{paymentType}"?').replace("{amount}",h.default.filter("currency")(p)).replace("{paymentType}",l.label),onAction:function(t){if(t){var e={identifier:l.identifier,label:l.label,value:p,readonly:!1,selected:!0};f.addPayment(e),d[0].paid=!0,r({status:"success",message:(0,o.__)("Layaway defined"),data:{order:u}})}else n({status:"failed",message:(0,o.__)("The request was canceled")})}});case 19:e.next=24;break;case 21:return e.prev=21,e.t0=e.catch(3),e.abrupt("return",n(e.t0));case 24:case"end":return e.stop()}}),e,this,[[3,21]])})))}))}},{key:"submitOrder",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(r,n){return j(t,void 0,void 0,x().mark((function t(){var i,a,u,c,l,d=this;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=Object.assign(Object.assign({},this.order.getValue()),e),a=i.customer.group.minimal_credit_payment,"hold"===i.payment_status){t.next=20;break}if(!(0===i.payments.length||i.total>i.tendered)){t.next=20;break}if("no"!==this.options.getValue().ns_orders_allow_partial){t.next=9;break}return u=(0,o.__)("Partially paid orders are disabled."),t.abrupt("return",n({status:"failed",message:u}));case 9:if(!(a>=0)){t.next=20;break}return t.prev=10,t.next=13,this.canProceedAsLaidAway(i);case 13:c=t.sent,i=c.data.order,t.next=20;break;case 17:return t.prev=17,t.t0=t.catch(10),t.abrupt("return",n(t.t0));case 20:if(this._isSubmitting){t.next=24;break}return l=void 0!==i.id?"put":"post",this._isSubmitting=!0,t.abrupt("return",s.ih[l]("/api/nexopos/v4/orders".concat(void 0!==i.id?"/"+i.id:""),i).subscribe({next:function(t){r(t),d.reset(),s.kq.doAction("ns-order-submit-successful",t),d._isSubmitting=!1;var e=d.options.getValue().ns_pos_complete_sale_audio;e.length>0&&new Audio(e).play()},error:function(t){d._isSubmitting=!1,n(t),s.kq.doAction("ns-order-submit-failed",t)}}));case 24:return t.abrupt("return",n({status:"failed",message:(0,o.__)("An order is currently being processed.")}));case 25:case"end":return t.stop()}}),t,this,[[10,17]])})))}))}},{key:"loadOrder",value:function(t){var e=this;return new Promise((function(r,n){s.ih.get("/api/nexopos/v4/orders/".concat(t,"/pos")).subscribe({next:function(t){return j(e,void 0,void 0,x().mark((function e(){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object.assign(Object.assign({},this.defaultOrder()),t),n=t.products.map((function(t){return t.$original=function(){return t.product},t.$quantities=function(){return t.product.unit_quantities.filter((function(e){return+e.id==+t.unit_quantity_id}))[0]},t})),t.type=Object.values(this.types.getValue()).filter((function(e){return e.identifier===t.type}))[0],t.addresses={shipping:t.shipping_address,billing:t.billing_address},delete t.shipping_address,delete t.billing_address,this.buildOrder(t),this.buildProducts(n),e.next=10,this.selectCustomer(t.customer);case 10:r(t);case 11:case"end":return e.stop()}}),e,this)})))},error:function(t){return n(t)}})}))}},{key:"buildOrder",value:function(t){this.order.next(t)}},{key:"buildProducts",value:function(t){this.refreshProducts(t),this.products.next(t)}},{key:"printOrderReceipt",value:function(t){var e=this.options.getValue();if("disabled"===e.ns_pos_printing_enabled_for)return!1;if("all_orders"===e.ns_pos_printing_enabled_for)this.printOrder(t.id);else if("partially_paid_orders"===e.ns_pos_printing_enabled_for&&["paid","partially_paid"].includes(t.payment_status))this.printOrder(t.id);else{if("only_paid_ordes"!==e.ns_pos_printing_enabled_for||!["paid"].includes(t.payment_status))return!1;this.printOrder(t.id)}}},{key:"printOrder",value:function(t){var e=this.options.getValue();if("disabled"===e.ns_pos_printing_enabled_for)return!1;"default"===e.ns_pos_printing_gateway?this.processRegularPrinting(t):this.processCustomPrinting(t,e.ns_pos_printing_gateway)}},{key:"processCustomPrinting",value:function(t,e){s.kq.applyFilters("ns-order-custom-print",{printed:!1,order_id:t,gateway:e}).printed||s.kX.error((0,o.__)("Unsupported print gateway.")).subscribe()}},{key:"processRegularPrinting",value:function(t){var e=document.querySelector("printing-section");e&&e.remove();var r=document.createElement("iframe");r.id="printing-section",r.className="hidden",r.src=this.settings.getValue().urls.sale_printing_url.replace("{id}",t),document.body.appendChild(r)}},{key:"computePaid",value:function(){var t=this._order.getValue();t.tendered=0,t.payments.length>0&&(t.tendered=t.payments.map((function(t){return t.value})).reduce((function(t,e){return e+t}))),t.tendered>=t.total?t.payment_status="paid":t.tendered>0&&t.tendered<t.total&&(t.payment_status="partially_paid"),t.change=t.tendered-t.total,this._order.next(t)}},{key:"setPaymentActive",value:function(t){var e=this._paymentsType.getValue(),r=e.indexOf(t);e.forEach((function(t){return t.selected=!1})),e[r].selected=!0,this._paymentsType.next(e)}},{key:"definedPaymentsType",value:function(t){this._paymentsType.next(t)}},{key:"selectCustomer",value:function(t){var e=this;return new Promise((function(r,n){var i=e.order.getValue();if(i.customer=t,i.customer_id=t.id,e.order.next(i),void 0!==t.group&&null!==t.group)return r(i);s.ih.get("/api/nexopos/v4/customers/".concat(t.id,"/group")).subscribe({next:function(t){i.customer.group=t,e.order.next(i),r(i)},error:function(t){n(t)}})}))}},{key:"updateCart",value:function(t,e){for(var r in e)void 0!==e[r]&&h.default.set(t,r,e[r]);this.order.next(t),this.refreshCart()}},{key:"checkCart",value:function(){var t=this,e=this.order.getValue(),r=[];e.coupons.forEach((function(t){t.products.length>0&&(e.products.filter((function(e){return t.products.map((function(t){return t.product_id})).includes(e.product_id)})).length>0||-1!==r.indexOf(t)||r.push(t)),t.categories.length>0&&(e.products.filter((function(e){return t.categories.map((function(t){return t.category_id})).includes(e.$original().category_id)})).length>0||-1!==r.indexOf(t)||r.push(t))})),r.forEach((function(e){s.kX.error((0,o.__)('The coupons "%s" has been removed from the cart, as it\'s required conditions are no more meet.').replace("%s",e.name),(0,o.__)("Okay"),{duration:6e3}).subscribe(),t.removeCoupon(e)}))}},{key:"refreshCart",value:function(){return j(this,void 0,void 0,x().mark((function t(){var e,r,n,i,a,u,c,l,d;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.checkCart(),e=this.products.getValue(),r=this.order.getValue(),(n=e.map((function(t){return t.total_price}))).length>0?r.subtotal=n.reduce((function(t,e){return t+e})):r.subtotal=0,i=r.coupons.map((function(t){return"percentage_discount"===t.type?(t.value=r.subtotal*t.discount_value/100,t.value):(t.value=t.discount_value,t.value)})),r.total_coupons=0,i.length>0&&(r.total_coupons=i.reduce((function(t,e){return t+e}))),"percentage"===r.discount_type&&(r.discount=r.discount_percentage*r.subtotal/100),r.discount>r.subtotal&&0===r.total_coupons&&(r.discount=r.subtotal,s.kX.info("The discount has been set to the cart subtotal").subscribe()),r.tax_value=0,this.order.next(r),t.prev=12,t.next=15,this.computeTaxes();case 15:a=t.sent,r=a.data.order,t.next=22;break;case 19:t.prev=19,t.t0=t.catch(12),!1!==t.t0&&void 0!==t.t0.message&&s.kX.error(t.t0.message||(0,o.__)("An unexpected error has occured while fecthing taxes."),(0,o.__)("OKAY"),{duration:0}).subscribe();case 22:(u=e.map((function(t){return"inclusive"===t.tax_type?t.tax_value:0}))).length>0&&u.reduce((function(t,e){return t+e})),c=r.tax_type,l=this.options.getValue().ns_pos_vat,d=0,(["flat_vat","variable_vat"].includes(l)||["products_vat","products_flat_vat","products_variable_vat"].includes(l))&&(d=r.tax_value),r.total="exclusive"===c?+(r.subtotal+(r.shipping||0)+d-r.discount-r.total_coupons).toFixed(ns.currency.ns_currency_precision):+(r.subtotal+(r.shipping||0)-r.discount-r.total_coupons).toFixed(ns.currency.ns_currency_precision),this.order.next(r),s.kq.doAction("ns-cart-after-refreshed",r);case 32:case"end":return t.stop()}}),t,this,[[12,19]])})))}},{key:"getStockUsage",value:function(t,e){var r=this._products.getValue().filter((function(r){return r.product_id===t&&r.unit_quantity_id===e})).map((function(t){return t.quantity}));return r.length>0?r.reduce((function(t,e){return t+e})):0}},{key:"addToCart",value:function(t){return j(this,void 0,void 0,x().mark((function e(){var r,n,i,s,o,a,u;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new Object,n={product_id:t.id||0,name:t.name,discount_type:"percentage",discount:0,discount_percentage:0,quantity:t.quantity||0,tax_group_id:t.tax_group_id,tax_type:t.tax_type||void 0,tax_value:0,unit_id:t.unit_id||0,unit_price:t.unit_price||0,unit_name:t.unit_name||"",total_price:0,mode:"normal",$original:t.$original||function(){return t},$quantities:t.$quantities||void 0},this._processingAddQueue=!0,0===n.product_id){e.next=22;break}e.t0=x().keys(this.addToCartQueue);case 5:if((e.t1=e.t0()).done){e.next=22;break}return i=e.t1.value,e.prev=7,s=new this.addToCartQueue[i](n),e.next=11,s.run(r);case 11:o=e.sent,r=Object.assign(Object.assign({},r),o),e.next=20;break;case 15:if(e.prev=15,e.t2=e.catch(7),!1!==e.t2){e.next=20;break}return this._processingAddQueue=!1,e.abrupt("return",!1);case 20:e.next=5;break;case 22:this._processingAddQueue=!1,n=Object.assign(Object.assign({},n),r),(a=this._products.getValue()).unshift(n),this.refreshProducts(a),this._products.next(a),(u=this.options.getValue().ns_pos_new_item_audio).length>0&&new Audio(u).play();case 30:case"end":return e.stop()}}),e,this,[[7,15]])})))}},{key:"defineTypes",value:function(t){this._types.next(t)}},{key:"removeProduct",value:function(t){var e=this._products.getValue(),r=e.indexOf(t);e.splice(r,1),this._products.next(e)}},{key:"updateProduct",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this._products.getValue();r=null===r?n.indexOf(t):r,h.default.set(n,r,Object.assign(Object.assign({},t),e)),this.refreshProducts(n),this._products.next(n)}},{key:"refreshProducts",value:function(t){var e=this;t.forEach((function(t){e.computeProduct(t)}))}},{key:"computeProductTax",value:function(t){switch(console.log(t.mode),t.mode){case"custom":return this.computeCustomProductTax(t);case"normal":return this.computeNormalProductTax(t);case"wholesale":return this.computeWholesaleProductTax(t);default:return t}}},{key:"proceedProductTaxComputation",value:function(t,e){var r=this,n=t.$original(),i=n.tax_group,s=0,o=0,a=0;if(void 0!==i.taxes){var u=0;i.taxes.length>0&&(u=i.taxes.map((function(t){return t.rate})).reduce((function(t,e){return t+e})));var c=this.getNetPrice(e,u,n.tax_type);switch(n.tax_type){case"inclusive":s=c,a=e;break;case"exclusive":s=e,a=c}var l=i.taxes.map((function(t){return r.getVatValue(e,t.rate,n.tax_type)}));l.length>0&&(o=l.reduce((function(t,e){return t+e})))}return{price_without_tax:s,tax_value:o,price_with_tax:a}}},{key:"computeCustomProductTax",value:function(t){t.$original();var e=t.$quantities(),r=this.proceedProductTaxComputation(t,e.custom_price_edit);return e.excl_tax_custom_price=r.price_without_tax,e.incl_tax_custom_price=r.price_with_tax,e.custom_price_tax=r.tax_value,t.$quantities=function(){return e},t}},{key:"computeNormalProductTax",value:function(t){t.$original();var e=t.$quantities(),r=this.proceedProductTaxComputation(t,e.sale_price_edit);return e.excl_tax_sale_price=r.price_without_tax,e.incl_tax_sale_price=r.price_with_tax,e.sale_price_tax=r.tax_value,t.$quantities=function(){return e},t}},{key:"computeWholesaleProductTax",value:function(t){t.$original();var e=t.$quantities(),r=this.proceedProductTaxComputation(t,e.wholesale_price_edit);return e.excl_tax_wholesale_price=r.price_without_tax,e.incl_tax_wholesale_price=r.price_with_tax,e.wholesale_price_tax=r.tax_value,t.$quantities=function(){return e},t}},{key:"computeProduct",value:function(t){"normal"===t.mode?(t.unit_price=this.getSalePrice(t.$quantities(),t.$original()),t.tax_value=t.$quantities().sale_price_tax*t.quantity):"wholesale"===t.mode&&(t.unit_price=this.getWholesalePrice(t.$quantities(),t.$original()),t.tax_value=t.$quantities().wholesale_price_tax*t.quantity),"custom"===t.mode&&(t.unit_price=this.getCustomPrice(t.$quantities(),t.$original()),t.tax_value=t.$quantities().custom_price_tax*t.quantity),["flat","percentage"].includes(t.discount_type)&&"percentage"===t.discount_type&&(t.discount=t.unit_price*t.discount_percentage/100*t.quantity),t.total_price=t.unit_price*t.quantity-t.discount,s.kq.doAction("ns-after-product-computed",t)}},{key:"loadCustomer",value:function(t){return s.ih.get("/api/nexopos/v4/customers/".concat(t))}},{key:"defineSettings",value:function(t){this._settings.next(t)}},{key:"voidOrder",value:function(t){var e=this;void 0!==t.id?["hold"].includes(t.payment_status)?i.G.show(V,{title:"Order Deletion",message:"The current order will be deleted as no payment has been made so far.",onAction:function(r){r&&s.ih.delete("/api/nexopos/v4/orders/".concat(t.id)).subscribe((function(t){s.kX.success(t.message).subscribe(),e.reset()}),(function(t){return s.kX.error(t.message).subscribe()}))}}):i.G.show(A,{title:"Void The Order",message:"The current order will be void. This will cancel the transaction, but the order won't be deleted. Further details about the operation will be tracked on the report. Consider providing the reason of this operation.",onAction:function(r){!1!==r&&s.ih.post("/api/nexopos/v4/orders/".concat(t.id,"/void"),{reason:r}).subscribe({next:function(t){s.kX.success(t.message).subscribe(),e.reset()},error:function(t){return s.kX.error(t.message).subscribe()}})}}):s.kX.error("Unable to void an unpaid order.").subscribe()}},{key:"triggerOrderTypeSelection",value:function(t){return j(this,void 0,void 0,x().mark((function e(){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.orderTypeQueue.length)){e.next=8;break}return e.next=4,this.orderTypeQueue[r].promise(t);case 4:e.sent;case 5:r++,e.next=1;break;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"set",value:function(t,e){var r=this.settings.getValue();r[t]=e,this.settings.next(r)}},{key:"unset",value:function(t){var e=this.settings.getValue();delete e[t],this.settings.next(e)}},{key:"get",value:function(t){return this.settings.getValue()[t]}},{key:"destroy",value:function(){this._products.unsubscribe(),this._customers.unsubscribe(),this._types.unsubscribe(),this._breadcrumbs.unsubscribe(),this._paymentsType.unsubscribe(),this._screen.unsubscribe(),this._order.unsubscribe(),this._settings.unsubscribe()}}],r&&C(e.prototype,r),a&&C(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();window.POS=new Z,window.POSClass=Z;window.POS},6700:(t,e,r)=>{var n={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-ps":315,"./ar-ps.js":315,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":7093,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":7093,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":4415,"./fy.js":4415,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku-kmr":563,"./ku-kmr.js":563,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":238,"./ru.js":238,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function i(t){var e=s(t);return r(e)}function s(t){if(!r.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}i.keys=function(){return Object.keys(n)},i.resolve=s,t.exports=i,i.id=6700},3571:(t,e,r)=>{"use strict";r.d(e,{Z:()=>o});function n(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}const s={name:"ns-numpad",props:["value","currency","floating","limit"],data:function(){return{number:parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(t){return 0})).join("")),screenValue:0,order:null,cursor:parseInt(ns.currency.ns_currency_precision),orderSubscription:null,allSelected:!0,keys:[].concat(n([7,8,9].map((function(t){return{identifier:t,value:t}}))),n([4,5,6].map((function(t){return{identifier:t,value:t}}))),n([1,2,3].map((function(t){return{identifier:t,value:t}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){this.floating&&this.value>0?this.screenValue=parseFloat(this.value/this.number):this.screenValue=0},watch:{value:function(){this.value.toString().length>0&&(this.floating?this.screenValue=Math.round(this.value*this.number).toString():this.screenValue=this.value)}},methods:{increaseBy:function(t){var e=parseInt(1+new Array(this.cursor).fill("").map((function(t){return 0})).join(""));this.screenValue=(parseFloat(t.value)*e+(parseFloat(this.screenValue)||0)).toString(),this.allSelected=!1},inputValue:function(t){var e=parseInt(1+new Array(this.cursor).fill("").map((function(t){return 0})).join(""));if("next"!==t.identifier){if("backspace"===t.identifier)this.allSelected?(this.screenValue="0",this.allSelected=!1):this.screenValue=this.screenValue.toString().substr(0,this.screenValue.length-1);else if(t.value.toString().match(/^\d+$/)){if(this.limit>0&&this.screenValue.length>=this.limit)return;this.allSelected?(this.screenValue=t.value.toString(),this.allSelected=!1):(this.screenValue+=""+t.value.toString(),"percentage"===this.mode&&(this.screenValue=this.screenValue>100?100:this.screenValue))}"0"===this.screenValue&&(this.screenValue="");var r=this.floating&&this.screenValue.length>0?parseFloat(this.screenValue/this.number):this.screenValue;this.$emit("changed",r)}else this.$emit("next",this.floating&&this.screenValue.length>0?parseFloat(this.screenValue/e):this.screenValue)}}};const o=(0,r(1900).Z)(s,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"grid grid-flow-row grid-cols-3 gap-2 grid-rows-3",staticStyle:{padding:"1px"},attrs:{id:"numpad"}},[t._l(t.keys,(function(r,n){return e("div",{key:n,staticClass:"select-none hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",staticStyle:{margin:"-1px"},on:{click:function(e){return t.inputValue(r)}}},[void 0!==r.value?e("span",[t._v(t._s(r.value))]):t._e(),t._v(" "),r.icon?e("i",{staticClass:"las",class:r.icon}):t._e()])})),t._v(" "),t._t("numpad-footer")],2)}),[],!1,null,null,null).exports},1156:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});const n={name:"ns-paginate",props:["pagination"],data:function(){return{page:1,path:""}},mounted:function(){this.path=this.pagination.path},computed:{getPagination:function(){return this.pagination?this.pageNumbers(this.pagination.last_page,this.pagination.current_page):[]}},methods:{gotoPage:function(t){this.page=t,this.$emit("load","".concat(this.path,"?page=").concat(this.page))},pageNumbers:function(t,e){var r=[];e-3>1&&r.push(1,"...");for(var n=1;n<=t;n++)e+3>n&&e-3<n&&r.push(n);return e+3<t&&r.push("...",t),console.log(r),r.filter((function(t){return t>0||"string"==typeof t}))}}};const i=(0,r(1900).Z)(n,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex -mx-1",attrs:{id:"pagination"}},[t.pagination.current_page?[e("a",{staticClass:"mx-1 flex items-center justify-center h-8 w-8 rounded-full bg-gray-200 text-gray-700 hover:bg-blue-400 hover:text-white shadow",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.gotoPage(t.pagination.first_page)}}},[e("i",{staticClass:"las la-angle-double-left"})]),t._v(" "),t._l(t.getPagination,(function(r,n){return["..."!==t.page?e("a",{key:n,staticClass:"mx-1 flex items-center justify-center h-8 w-8 rounded-full hover:bg-blue-400 hover:text-white",class:t.page==r?"bg-blue-400 text-white":"bg-gray-200 text-gray-700",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.gotoPage(r)}}},[t._v(t._s(r))]):t._e(),t._v(" "),"..."===t.page?e("a",{key:n,staticClass:"mx-1 flex items-center justify-center h-8 w-8 rounded-full bg-gray-200 text-gray-700",attrs:{href:"javascript:void(0)"}},[t._v("...")]):t._e()]})),t._v(" "),e("a",{staticClass:"mx-1 flex items-center justify-center h-8 w-8 rounded-full bg-gray-200 text-gray-700 hover:bg-blue-400 hover:text-white shadow",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.gotoPage(t.pagination.last_page)}}},[e("i",{staticClass:"las la-angle-double-right"})])]:t._e()],2)}),[],!1,null,null,null).exports},6442:(t,e,r)=>{"use strict";r.d(e,{Z:()=>o});var n=r(2285),i=r(2384);const s={name:"ns-pos-customers-button",methods:{__:r(9165).__,openPendingOrdersPopup:function(){(new n.G).open(i.Z)}}};const o=(0,r(1900).Z)(s,(function(){var t=this,e=t._self._c;return e("button",{staticClass:"flex-shrink-0 h-12 flex items-center shadow rounded px-2 py-1 text-sm bg-white text-gray-700",on:{click:function(e){return t.openPendingOrdersPopup()}}},[e("i",{staticClass:"mr-1 text-xl lar la-user-circle"}),t._v(" "),e("span",[t._v(t._s(t.__("Customers")))])])}),[],!1,null,null,null).exports},8867:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});const n={name:"ns-pos-dashboard-button",methods:{__:r(9165).__,goToDashboard:function(){return document.location=POS.settings.getValue().urls.dashboard_url}}};const i=(0,r(1900).Z)(n,(function(){var t=this,e=t._self._c;return e("button",{staticClass:"flex-shrink-0 h-12 flex items-center shadow rounded px-2 py-1 text-sm bg-white text-gray-700",on:{click:function(e){return t.goToDashboard()}}},[e("i",{staticClass:"mr-1 text-xl las la-tachometer-alt"}),t._v(" "),e("span",[t._v(t._s(t.__("Dashboard")))])])}),[],!1,null,null,null).exports},1159:(t,e,r)=>{"use strict";r.d(e,{Z:()=>o});var n=r(2285),i=r(8997);const s={name:"ns-pos-delivery-button",methods:{__:r(9165).__,openPendingOrdersPopup:function(){new n.G({primarySelector:"#pos-app",popupClass:"shadow-lg bg-white w-3/5 md:w-2/3 lg:w-2/5 xl:w-2/4"}).open(i.Z)}}};const o=(0,r(1900).Z)(s,(function(){var t=this,e=t._self._c;return e("button",{staticClass:"flex-shrink-0 h-12 flex items-center shadow rounded px-2 py-1 text-sm bg-white text-gray-700",on:{click:function(e){return t.openPendingOrdersPopup()}}},[e("i",{staticClass:"mr-1 text-xl las la-truck"}),t._v(" "),e("span",[t._v(t._s(t.__("Order Type")))])])}),[],!1,null,null,null).exports},8741:(t,e,r)=>{"use strict";r.d(e,{Z:()=>h});var n=r(2285),i=r(277),s=r(7995),o=r(9165);const a={data:function(){return{products:[],isLoading:!1}},computed:{order:function(){return this.$popupParams.order}},mounted:function(){this.loadProducts()},methods:{__:o.__,close:function(){this.$popupParams.reject(!1),this.$popup.close()},loadProducts:function(){var t=this;this.isLoading=!0;var e=this.$popupParams.order.id;i.ih.get("/api/nexopos/v4/orders/".concat(e,"/products")).subscribe((function(e){t.isLoading=!1,t.products=e}))},openOrder:function(){this.$popup.close(),this.$popupParams.resolve(this.order)}}};var u=r(1900);const c=(0,u.Z)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-lg bg-white w-6/7-screen md:w-3/5-screen lg:w-2/5-screen h-6/7-screen flex flex-col overflow-hidden"},[e("div",{staticClass:"p-2 flex justify-between text-gray-700 items-center border-b"},[e("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("Products"))+"  "+t._s(t.order.code)+" "),t.order.title?e("span",[t._v("("+t._s(t.order.title)+")")]):t._e()]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),e("div",{staticClass:"flex-auto p-2 overflow-y-auto"},[t.isLoading?e("div",{staticClass:"flex-auto relative"},[e("div",{staticClass:"h-full w-full flex items-center justify-center"},[e("ns-spinner")],1)]):t._e(),t._v(" "),t.isLoading?t._e():t._l(t.products,(function(r){return e("div",{key:r.id,staticClass:"item"},[e("div",{staticClass:"flex-col border-b border-blue-400 py-2"},[e("div",{staticClass:"title font-semibold text-gray-700 flex justify-between"},[e("span",[t._v(t._s(r.name)+" (x"+t._s(r.quantity)+")")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(r.total_price)))])]),t._v(" "),e("div",{staticClass:"text-sm text-gray-600"},[e("ul",[e("li",[t._v(t._s(t.__("Unit"))+" : "+t._s(r.unit.name))])])])])])}))],2),t._v(" "),e("div",{staticClass:"flex justify-end p-2 border-t border-gray-400"},[e("div",{staticClass:"px-1"},[e("div",{staticClass:"-mx-2 flex"},[e("div",{staticClass:"px-1"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.openOrder()}}},[t._v(t._s(t.__("Open")))])],1),t._v(" "),e("div",{staticClass:"px-1"},[e("ns-button",{attrs:{type:"danger"},on:{click:function(e){return t.close()}}},[t._v(t._s(t.__("Close")))])],1)])])])])}),[],!1,null,null,null).exports;const l={props:["orders"],data:function(){return{searchField:""}},watch:{orders:function(){i.kq.doAction("ns-pos-pending-orders-refreshed",this.orders)}},mounted:function(){},name:"ns-pos-pending-order",methods:{__:o.__,previewOrder:function(t){this.$emit("previewOrder",t)},proceedOpenOrder:function(t){this.$emit("proceedOpenOrder",t)},searchOrder:function(){this.$emit("searchOrder",this.searchField)},printOrder:function(t){this.$emit("printOrder",t)}}};const d={components:{nsPosPendingOrders:(0,u.Z)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-auto flex-col overflow-hidden"},[e("div",{staticClass:"p-1"},[e("div",{staticClass:"flex rounded border-2 border-blue-400"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchField,expression:"searchField"}],staticClass:"p-2 outline-none flex-auto",attrs:{type:"text"},domProps:{value:t.searchField},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchOrder()},input:function(e){e.target.composing||(t.searchField=e.target.value)}}}),t._v(" "),e("button",{staticClass:"w-16 md:w-24 bg-blue-400 text-white",on:{click:function(e){return t.searchOrder()}}},[e("i",{staticClass:"las la-search"}),t._v(" "),e("span",{staticClass:"mr-1 hidden md:visible"},[t._v(t._s(t.__("Search")))])])])]),t._v(" "),e("div",{staticClass:"overflow-y-auto flex flex-auto"},[e("div",{staticClass:"flex p-2 flex-auto flex-col overflow-y-auto"},[t._l(t.orders,(function(r){return e("div",{key:r.id,staticClass:"border-b border-blue-400 w-full py-2",attrs:{"data-order-id":r.id}},[e("h3",{staticClass:"text-gray-700"},[t._v(t._s(r.title||"Untitled Order"))]),t._v(" "),e("div",{staticClass:"px-2"},[e("div",{staticClass:"flex flex-wrap -mx-4"},[e("div",{staticClass:"w-full md:w-1/2 px-2"},[e("p",{staticClass:"text-sm text-gray-600"},[e("strong",[t._v(t._s(t.__("Code")))]),t._v(" : "+t._s(r.code))]),t._v(" "),e("p",{staticClass:"text-sm text-gray-600"},[e("strong",[t._v(t._s(t.__("Cashier")))]),t._v(" : "+t._s(r.nexopos_users_username))]),t._v(" "),e("p",{staticClass:"text-sm text-gray-600"},[e("strong",[t._v(t._s(t.__("Total")))]),t._v(" : "+t._s(t._f("currency")(r.total)))]),t._v(" "),e("p",{staticClass:"text-sm text-gray-600"},[e("strong",[t._v(t._s(t.__("Tendered")))]),t._v(" : "+t._s(t._f("currency")(r.tendered)))])]),t._v(" "),e("div",{staticClass:"w-full md:w-1/2 px-2"},[e("p",{staticClass:"text-sm text-gray-600"},[e("strong",[t._v(t._s(t.__("Customer")))]),t._v(" : "+t._s(r.nexopos_customers_name))]),t._v(" "),e("p",{staticClass:"text-sm text-gray-600"},[e("strong",[t._v(t._s(t.__("Date")))]),t._v(" : "+t._s(r.created_at))]),t._v(" "),e("p",{staticClass:"text-sm text-gray-600"},[e("strong",[t._v(t._s(t.__("Type")))]),t._v(" : "+t._s(r.type))])])])]),t._v(" "),e("div",{staticClass:"flex justify-end w-full mt-2"},[e("div",{staticClass:"flex rounded-lg overflow-hidden buttons-container"},[e("button",{staticClass:"text-white bg-green-400 outline-none px-2 py-1",on:{click:function(e){return t.proceedOpenOrder(r)}}},[e("i",{staticClass:"las la-lock-open"}),t._v(" "+t._s(t.__("Open")))]),t._v(" "),e("button",{staticClass:"text-white bg-blue-400 outline-none px-2 py-1",on:{click:function(e){return t.previewOrder(r)}}},[e("i",{staticClass:"las la-eye"}),t._v(" "+t._s(t.__("Products")))]),t._v(" "),e("button",{staticClass:"text-white bg-teal-400 outline-none px-2 py-1",on:{click:function(e){return t.printOrder(r)}}},[e("i",{staticClass:"las la-print"}),t._v(" "+t._s(t.__("Print")))])])])])})),t._v(" "),0===t.orders.length?e("div",{staticClass:"h-full v-full items-center justify-center flex"},[e("h3",{staticClass:"text-semibold text-gray-700"},[t._v(t._s(t.__("Nothing to display...")))])]):t._e()],2)])])}),[],!1,null,null,null).exports},methods:{__:o.__,searchOrder:function(t){var e=this;i.ih.get("/api/nexopos/v4/crud/".concat(this.active,"?search=").concat(t)).subscribe((function(t){e.orders=t.data}))},setActiveTab:function(t){this.active=t,this.loadOrderFromType(t)},openOrder:function(t){POS.loadOrder(t.id),this.$popup.close()},loadOrderFromType:function(t){var e=this;i.ih.get("/api/nexopos/v4/crud/".concat(t)).subscribe((function(t){e.orders=t.data}))},previewOrder:function(t){var e=this;new Promise((function(e,r){Popup.show(c,{order:t,resolve:e,reject:r})})).then((function(r){e.proceedOpenOrder(t)}),(function(t){return t}))},printOrder:function(t){POS.printOrderReceipt(t)},proceedOpenOrder:function(t){var e=this;if(POS.products.getValue().length>0)return Popup.show(s.Z,{title:"Confirm Your Action",message:"The cart is not empty. Opening an order will clear your cart would you proceed ?",onAction:function(r){r&&e.openOrder(t)}});this.openOrder(t)}},data:function(){return{active:"ns.hold-orders",searchField:"",orders:[]}},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.$popup.close()})),this.loadOrderFromType(this.active)}};const p=(0,u.Z)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-lg bg-white w-6/7-screen md:w-3/5-screen lg:w-2/5-screen h-6/7-screen flex flex-col overflow-hidden"},[e("div",{staticClass:"p-2 flex justify-between text-gray-700 items-center border-b"},[e("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("Orders")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.$popup.close()}}})],1)]),t._v(" "),e("div",{staticClass:"p-2 flex overflow-hidden flex-auto"},[e("ns-tabs",{attrs:{active:t.active},on:{changeTab:function(e){return t.setActiveTab(e)}}},[e("ns-tabs-item",{staticClass:"flex flex-col overflow-hidden",attrs:{identifier:"ns.hold-orders",label:t.__("On Hold"),padding:"p-0"}},[e("ns-pos-pending-orders",{attrs:{orders:t.orders},on:{searchOrder:function(e){return t.searchOrder(e)},previewOrder:function(e){return t.previewOrder(e)},printOrder:function(e){return t.printOrder(e)},proceedOpenOrder:function(e){return t.proceedOpenOrder(e)}}})],1),t._v(" "),e("ns-tabs-item",{staticClass:"flex flex-col overflow-hidden",attrs:{identifier:"ns.unpaid-orders",label:t.__("Unpaid"),padding:"p-0"}},[e("ns-pos-pending-orders",{attrs:{orders:t.orders},on:{searchOrder:function(e){return t.searchOrder(e)},previewOrder:function(e){return t.previewOrder(e)},printOrder:function(e){return t.printOrder(e)},proceedOpenOrder:function(e){return t.proceedOpenOrder(e)}}})],1),t._v(" "),e("ns-tabs-item",{staticClass:"flex flex-col overflow-hidden",attrs:{identifier:"ns.partially-paid-orders",label:t.__("Partially Paid"),padding:"p-0"}},[e("ns-pos-pending-orders",{attrs:{orders:t.orders},on:{searchOrder:function(e){return t.searchOrder(e)},previewOrder:function(e){return t.previewOrder(e)},printOrder:function(e){return t.printOrder(e)},proceedOpenOrder:function(e){return t.proceedOpenOrder(e)}}})],1)],1)],1),t._v(" "),e("div",{staticClass:"p-2 flex justify-between border-t bg-gray-200"},[e("div"),t._v(" "),e("div",[e("ns-button",[t._v(t._s(t.__("Close")))])],1)])])}),[],!1,null,null,null).exports,f={name:"ns-pos-pending-orders-button",methods:{__:o.__,openPendingOrdersPopup:function(){(new n.G).open(p)}}};const h=(0,u.Z)(f,(function(){var t=this,e=t._self._c;return e("button",{staticClass:"flex-shrink-0 h-12 flex items-center shadow rounded px-2 py-1 text-sm bg-white text-gray-700",on:{click:function(e){return t.openPendingOrdersPopup()}}},[e("i",{staticClass:"mr-1 text-xl lar la-hand-pointer"}),t._v(" "),e("span",[t._v(t._s(t.__("Orders")))])])}),[],!1,null,null,null).exports},2445:(t,e,r)=>{"use strict";r.d(e,{Z:()=>A});var n=r(277),i=r(3571),s=r(40),o=r(4503),a=r(7995),u=r(9165);const c={components:{nsNumpad:i.Z},data:function(){return{amount:0,title:null,identifier:null,settingsSubscription:null,settings:null,action:null,loaded:!1,register_id:null,validation:new s.Z,fields:[]}},mounted:function(){var t=this;this.title=this.$popupParams.title,this.identifier=this.$popupParams.identifier,this.action=this.$popupParams.action,this.register_id=this.$popupParams.register_id,this.settingsSubscription=POS.settings.subscribe((function(e){t.settings=e})),this.loadFields()},destroyed:function(){this.settingsSubscription.unsubscribe()},methods:{popupCloser:o.Z,__:u.__,definedValue:function(t){this.amount=t},close:function(){this.$popup.close()},loadFields:function(){var t=this;this.loaded=!1,nsHttpClient.get("/api/nexopos/v4/fields/".concat(this.identifier)).subscribe((function(e){t.loaded=!0,t.fields=e}),(function(e){return t.loaded=!0,nsSnackBar.error(e.message,"OKAY",{duration:!1}).subscribe()}))},submit:function(t){var e=this;Popup.show(a.Z,{title:"Confirm Your Action",message:this.$popupParams.confirmMessage||"Would you like to confirm your action.",onAction:function(t){t&&e.triggerSubmit()}})},triggerSubmit:function(){var t=this,e=this.validation.extractFields(this.fields);e.amount=""===this.amount?0:this.amount,nsHttpClient.post("/api/nexopos/v4/cash-registers/".concat(this.action,"/").concat(this.register_id||this.settings.register.id),e).subscribe((function(e){t.$popupParams.resolve(e),t.$popup.close(),nsSnackBar.success(e.message).subscribe()}),(function(t){nsSnackBar.error(t.message).subscribe()}))}}};var l=r(1900);const d=(0,l.Z)(c,(function(){var t=this,e=t._self._c;return e("div",[t.loaded?e("div",{staticClass:"shadow-lg w-95vw md:w-2/5-screen bg-white"},[e("div",{staticClass:"border-b border-gray-200 p-2 text-gray-700 flex justify-between items-center"},[e("h3",{staticClass:"font-semibold"},[t._v(t._s(t.title))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),e("div",{staticClass:"p-2"},[null!==t.settings&&t.settings.register?e("div",{staticClass:"mb-2 p-3 bg-gray-400 font-bold text-white text-right flex justify-between"},[e("span",[t._v(t._s(t.__("Balance"))+" ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.settings.register.balance)))])]):t._e(),t._v(" "),e("div",{staticClass:"mb-2 p-3 bg-green-400 font-bold text-white text-right flex justify-between"},[e("span",[t._v(t._s(t.__("Input")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.amount)))])]),t._v(" "),e("div",{staticClass:"mb-2"},[e("ns-numpad",{attrs:{floating:!0,value:t.amount},on:{next:function(e){return t.submit(e)},changed:function(e){return t.definedValue(e)}}})],1),t._v(" "),t._l(t.fields,(function(t,r){return e("ns-field",{key:r,attrs:{field:t}})}))],2)]):t._e(),t._v(" "),t.loaded?t._e():e("div",{staticClass:"h-full w-full flex items-center justify-center"},[e("ns-spinner")],1)])}),[],!1,null,null,null).exports;var p=r(4914);function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function h(){h=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var s=e&&e.prototype instanceof b?e:b,o=Object.create(s.prototype),a=new $(n||[]);return i(o,"_invoke",{value:O(t,r,a)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",v="suspendedYield",m="executing",y="completed",_={};function b(){}function g(){}function w(){}var x={};c(x,o,(function(){return this}));var C=Object.getPrototypeOf,k=C&&C(C(V([])));k&&k!==r&&n.call(k,o)&&(x=k);var j=w.prototype=b.prototype=Object.create(x);function P(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(i,s,o,a){var u=d(t[i],t,s);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==f(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,o,a)}),(function(t){r("throw",t,o,a)})):e.resolve(l).then((function(t){c.value=t,o(c)}),(function(t){return r("throw",t,o,a)}))}a(u.arg)}var s;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return s=s?s.then(i,i):i()}})}function O(e,r,n){var i=p;return function(s,o){if(i===m)throw new Error("Generator is already running");if(i===y){if("throw"===s)throw o;return{value:t,done:!0}}for(n.method=s,n.arg=o;;){var a=n.delegate;if(a){var u=E(a,n);if(u){if(u===_)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=m;var c=d(e,r,n);if("normal"===c.type){if(i=n.done?y:v,c.arg===_)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=y,n.method="throw",n.arg=c.arg)}}}function E(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var s=d(i,e.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,_;var o=s.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,_):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function $(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function V(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(f(e)+" is not iterable")}return g.prototype=w,i(j,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:g,configurable:!0}),g.displayName=c(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,u,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},P(S.prototype),c(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,i,s){void 0===s&&(s=Promise);var o=new S(l(t,r,n,i),s);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},P(j),c(j,u,"Generator"),c(j,o,(function(){return this})),c(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=V,$.prototype={constructor:$,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,_):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),_},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),_}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:V(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),_}},e}function v(t,e,r,n,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,i)}const m={components:{nsNumpad:i.Z},data:function(){return{registers:[],priorVerification:!1,hasLoadedRegisters:!1,validation:new s.Z,amount:0,settings:null,settingsSubscription:null}},mounted:function(){var t=this;this.checkUsedRegister(),this.settingsSubscription=POS.settings.subscribe((function(e){t.settings=e}))},beforeDestroy:function(){this.settingsSubscription.unsubscribe()},computed:{},methods:{__:u.__,popupResolver:p.Z,selectRegister:function(t){var e,r=this;return(e=h().mark((function e(){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("closed"===t.status){e.next=2;break}return e.abrupt("return",n.kX.error((0,u.__)("Unable to open this register. Only closed register can be opened.")).subscribe());case 2:return e.prev=2,e.next=5,new Promise((function(e,r){var n=(0,u.__)("Open Register : %s").replace("%s",t.name),i=t.id;Popup.show(d,{resolve:e,reject:r,title:n,identifier:"ns.cash-registers-opening",action:"open",register_id:i})}));case 5:i=e.sent,r.popupResolver(i),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})),function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(t){v(s,n,i,o,a,"next",t)}function a(t){v(s,n,i,o,a,"throw",t)}o(void 0)}))})()},checkUsedRegister:function(){var t=this;this.priorVerification=!1,n.ih.get("/api/nexopos/v4/cash-registers/used").subscribe({next:function(e){t.$popupParams.resolve(e),t.$popup.close()},error:function(e){t.priorVerification=!0,n.kX.error(e.message).subscribe(),t.loadRegisters()}})},loadRegisters:function(){var t=this;this.hasLoadedRegisters=!1,n.ih.get("/api/nexopos/v4/cash-registers").subscribe((function(e){t.registers=e,t.hasLoadedRegisters=!0}))},getClass:function(t){switch(t.status){case"in-use":return"bg-teal-200 text-gray-800 cursor-not-allowed";case"disabled":return"bg-gray-200 text-gray-700 cursor-not-allowed";case"available":return"bg-green-100 text-gray-800"}return"border-gray-200 cursor-pointer hover:bg-blue-400 hover:text-white"}}};const y=(0,l.Z)(m,(function(){var t=this,e=t._self._c;return e("div",[!1===t.priorVerification?e("div",{staticClass:"h-full w-full py-10 flex justify-center items-center"},[e("ns-spinner",{attrs:{size:"24",border:"8"}})],1):t._e(),t._v(" "),e("div",{staticClass:"w-95vw md:w-3/5-screen lg:w-3/5-screen xl:w-2/5-screen flex flex-col overflow-hidden",class:t.priorVerification?"shadow-lg bg-white":""},[t.priorVerification?[e("div",{staticClass:"title p-2 border-b border-gray-200 flex justify-between items-center"},[e("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("Open The Register")))]),t._v(" "),t.settings?e("div",[e("a",{staticClass:"hover:bg-red-400 hover:border-red-500 hover:text-white rounded-full border border-gray-200 px-3 text-sm py-1",attrs:{href:t.settings.urls.orders_url}},[t._v(t._s(t.__("Exit To Orders")))])]):t._e()]),t._v(" "),t.hasLoadedRegisters?t._e():e("div",{staticClass:"py-10 flex-auto overflow-y-auto flex items-center justify-center"},[e("ns-spinner",{attrs:{size:"16",border:"4"}})],1),t._v(" "),t.hasLoadedRegisters?e("div",{staticClass:"flex-auto overflow-y-auto"},[e("div",{staticClass:"grid grid-cols-3"},t._l(t.registers,(function(r,n){return e("div",{key:n,staticClass:"border-b border-r flex items-center justify-center flex-col p-3",class:t.getClass(r),on:{click:function(e){return t.selectRegister(r)}}},[e("i",{staticClass:"las la-cash-register text-6xl"}),t._v(" "),e("h3",{staticClass:"text-semibold text-center"},[t._v(t._s(r.name))]),t._v(" "),e("span",{staticClass:"text-sm"},[t._v("("+t._s(r.status_label)+")")])])})),0),t._v(" "),0===t.registers.length?e("div",{staticClass:"p-2 bg-red-400 text-white"},[t._v("\n                    "+t._s(t.__("Looks like there is no registers. At least one register is required to proceed."))+"  "),e("a",{staticClass:"font-bold hover:underline",attrs:{href:t.settings.urls.registers_url}},[t._v(t._s(t.__("Create Cash Register")))])]):t._e()]):t._e()]:t._e()],2)])}),[],!1,null,null,null).exports;const _={data:function(){return{totalIn:0,totalOut:0,settings:null,settingsSubscription:null,histories:[]}},mounted:function(){var t=this;this.settingsSubscription=POS.settings.subscribe((function(e){t.settings=e})),this.getHistory()},destroyed:function(){this.settingsSubscription.unsubscribe()},methods:{__:u.__,popupResolver:p.Z,closePopup:function(){this.popupResolver({status:"success"})},getHistory:function(){var t=this;n.ih.get("/api/nexopos/v4/cash-registers/session-history/".concat(this.settings.register.id)).subscribe((function(e){t.histories=e,t.totalIn=t.histories.filter((function(t){return["register-opening","register-sale","register-cash-in"].includes(t.action)})).map((function(t){return parseFloat(t.value)})).reduce((function(t,e){return t+e}),0),t.totalOut=t.histories.filter((function(t){return["register-closing","register-refund","register-cash-out"].includes(t.action)})).map((function(t){return parseFloat(t.value)})).reduce((function(t,e){return t+e}),0),console.log(t.totalOut)}))}}};const b=(0,l.Z)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"bg-white shadow-lg w-95vw md:w-4/6-screen lg:w-half overflow-hidden"},[e("div",{staticClass:"p-2 flex justify-between items-center",attrs:{id:"header"}},[e("h3",{staticClass:"font-bold"},[t._v(t._s(t.__("Register History")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:t.closePopup}})],1)]),t._v(" "),e("div",{staticClass:"flex w-full"},[e("div",{staticClass:"flex flex-auto"},[e("div",{staticClass:"w-full md:w-1/2 text-right bg-green-400 text-white font-bold text-3xl p-3"},[t._v(t._s(t._f("currency")(t.totalIn)))]),t._v(" "),e("div",{staticClass:"w-full md:w-1/2 text-right bg-red-400 text-white font-bold text-3xl p-3"},[t._v(t._s(t._f("currency")(t.totalOut)))])])]),t._v(" "),e("div",{staticClass:"flex flex-col overflow-y-auto h-120"},[t._l(t.histories,(function(r){return[["register-sale","register-cash-in"].includes(r.action)?e("div",{key:r.id,staticClass:"flex border-b border-green-200 bg-green-100"},[e("div",{staticClass:"p-2 flex-auto"},[t._v(t._s(r.label))]),t._v(" "),e("div",{staticClass:"flex-auto text-right p-2"},[t._v(t._s(t._f("currency")(r.value)))])]):t._e(),t._v(" "),["register-opening"].includes(r.action)?e("div",{key:r.id,staticClass:"flex border-b border-blue-200 bg-blue-100"},[e("div",{staticClass:"p-2 flex-auto"},[t._v(t._s(r.label))]),t._v(" "),e("div",{staticClass:"flex-auto text-right p-2"},[t._v(t._s(t._f("currency")(r.value)))])]):t._e(),t._v(" "),["register-close"].includes(r.action)?e("div",{key:r.id,staticClass:"flex border-b border-teal-200 bg-teal-100"},[e("div",{staticClass:"p-2 flex-auto"},[t._v(t._s(r.label))]),t._v(" "),e("div",{staticClass:"flex-auto text-right p-2"},[t._v(t._s(t._f("currency")(r.value)))])]):t._e(),t._v(" "),["register-refund","register-cash-out"].includes(r.action)?e("div",{key:r.id,staticClass:"flex border-b border-red-200 bg-red-100"},[e("div",{staticClass:"p-2 flex-auto"},[t._v(t._s(r.label))]),t._v(" "),e("div",{staticClass:"flex-auto text-right p-2"},[t._v(t._s(t._f("currency")(r.value)))])]):t._e()]}))],2)])}),[],!1,null,null,null).exports;function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function w(){w=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var s=e&&e.prototype instanceof y?e:y,o=Object.create(s.prototype),a=new $(n||[]);return i(o,"_invoke",{value:O(t,r,a)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",f="suspendedYield",h="executing",v="completed",m={};function y(){}function _(){}function b(){}var x={};c(x,o,(function(){return this}));var C=Object.getPrototypeOf,k=C&&C(C(V([])));k&&k!==r&&n.call(k,o)&&(x=k);var j=b.prototype=y.prototype=Object.create(x);function P(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(i,s,o,a){var u=d(t[i],t,s);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==g(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,o,a)}),(function(t){r("throw",t,o,a)})):e.resolve(l).then((function(t){c.value=t,o(c)}),(function(t){return r("throw",t,o,a)}))}a(u.arg)}var s;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return s=s?s.then(i,i):i()}})}function O(e,r,n){var i=p;return function(s,o){if(i===h)throw new Error("Generator is already running");if(i===v){if("throw"===s)throw o;return{value:t,done:!0}}for(n.method=s,n.arg=o;;){var a=n.delegate;if(a){var u=E(a,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var c=d(e,r,n);if("normal"===c.type){if(i=n.done?v:f,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=v,n.method="throw",n.arg=c.arg)}}}function E(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var s=d(i,e.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,m;var o=s.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function $(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function V(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(g(e)+" is not iterable")}return _.prototype=b,i(j,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},P(S.prototype),c(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,i,s){void 0===s&&(s=Promise);var o=new S(l(t,r,n,i),s);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},P(j),c(j,u,"Generator"),c(j,o,(function(){return this})),c(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=V,$.prototype={constructor:$,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:V(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function C(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){k(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function k(t,e,r){var n;return n=function(t,e){if("object"!=g(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==g(n)?n:String(n))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j(t,e,r,n,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,i)}function P(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){j(s,n,i,o,a,"next",t)}function a(t){j(s,n,i,o,a,"throw",t)}o(void 0)}))}}const S={mounted:function(){var t=this;this.settingsSubscriber=POS.settings.subscribe((function(e){t.settings=e})),this.popupCloser(),this.loadRegisterSummary()},beforeDestroy:function(){this.settingsSubscriber.unsubscribe()},data:function(){return{settings:null,settingsSubscriber:null,register:{}}},methods:{__:u.__,popupResolver:p.Z,popupCloser:o.Z,loadRegisterSummary:function(){var t=this;nsHttpClient.get("/api/nexopos/v4/cash-registers/".concat(this.settings.register.id)).subscribe((function(e){t.register=e}))},closePopup:function(){this.popupResolver({status:"failed",button:"close_popup"})},closeCashRegister:function(){var t=this;return P(w().mark((function e(){var r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(t,e){Popup.show(d,{title:(0,u.__)("Close Register"),action:"close",identifier:"ns.cash-registers-closing",resolve:t,reject:e})}));case 3:r=e.sent,POS.unset("register"),t.popupResolver(C({button:"close_register"},r)),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},cashIn:function(){var t=this;return P(w().mark((function e(){var r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(t,e){Popup.show(d,{title:(0,u.__)("Cash In"),action:"register-cash-in",identifier:"ns.cash-registers-cashing",resolve:t,reject:e})}));case 3:r=e.sent,t.popupResolver(C({button:"close_register"},r)),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},cashOut:function(){var t=this;return P(w().mark((function e(){var r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(t,e){Popup.show(d,{title:(0,u.__)("Cash Out"),action:"register-cash-out",identifier:"ns.cash-registers-cashout",resolve:t,reject:e})}));case 3:r=e.sent,t.popupResolver(C({button:"close_register"},r)),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},historyPopup:function(){return P(w().mark((function t(){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){Popup.show(b,{resolve:t,reject:e})}));case 3:t.sent,t.next=9;break;case 6:throw t.prev=6,t.t0=t.catch(0),t.t0;case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()}}};const O=(0,l.Z)(S,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-lg w-95vw md:w-3/5-screen lg:w-2/4-screen bg-white"},[e("div",{staticClass:"p-2 border-b border-gray-200 flex items-center justify-between"},[e("h3",[t._v(t._s(t.__("Register Options")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),t.register.total_sale_amount&&t.register.balance?e("div",[e("div",{staticClass:"h-16 text-3xl bg-blue-400 text-white flex items-center justify-between px-3"},[e("span",{},[t._v(t._s(t.__("Sales")))]),t._v(" "),e("span",{staticClass:"font-bold"},[t._v(t._s(t._f("currency")(t.register.total_sale_amount)))])]),t._v(" "),e("div",{staticClass:"h-16 text-3xl bg-green-400 text-white flex items-center justify-between px-3"},[e("span",{},[t._v(t._s(t.__("Balance")))]),t._v(" "),e("span",{staticClass:"font-bold"},[t._v(t._s(t._f("currency")(t.register.balance)))])])]):t._e(),t._v(" "),void 0===t.register.total_sale_amount&&void 0===t.register.balance?e("div",{staticClass:"h-32 border-gray-200 border-b py-1 flex items-center justify-center"},[e("div",[e("ns-spinner",{attrs:{border:"4",size:"16"}})],1)]):t._e(),t._v(" "),e("div",{staticClass:"grid grid-cols-2 text-gray-700"},[e("div",{staticClass:"hover:bg-teal-100 border-gray-200 border-r border-b py-4 cursor-pointer px-2 flex items-center justify-center flex-col",on:{click:function(e){return t.closeCashRegister()}}},[e("i",{staticClass:"las la-sign-out-alt text-6xl"}),t._v(" "),e("h3",{staticClass:"text-xl font-bold"},[t._v(t._s(t.__("Close")))])]),t._v(" "),e("div",{staticClass:"hover:bg-green-100 border-gray-200 border-r border-b py-4 cursor-pointer px-2 flex items-center justify-center flex-col",on:{click:function(e){return t.cashIn()}}},[e("i",{staticClass:"las la-plus-circle text-6xl"}),t._v(" "),e("h3",{staticClass:"text-xl font-bold"},[t._v(t._s(t.__("Cash In")))])]),t._v(" "),e("div",{staticClass:"hover:bg-red-100 border-gray-200 border-r border-b py-4 cursor-pointer px-2 flex items-center justify-center flex-col",on:{click:function(e){return t.cashOut()}}},[e("i",{staticClass:"las la-minus-circle text-6xl"}),t._v(" "),e("h3",{staticClass:"text-xl font-bold"},[t._v(t._s(t.__("Cash Out")))])]),t._v(" "),e("div",{staticClass:"hover:bg-blue-100 border-gray-200 border-r border-b py-4 cursor-pointer px-2 flex items-center justify-center flex-col",on:{click:function(e){return t.historyPopup()}}},[e("i",{staticClass:"las la-history text-6xl"}),t._v(" "),e("h3",{staticClass:"text-xl font-bold"},[t._v(t._s(t.__("History")))])])])])}),[],!1,null,null,null).exports;function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function T(){T=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var s=e&&e.prototype instanceof y?e:y,o=Object.create(s.prototype),a=new $(n||[]);return i(o,"_invoke",{value:P(t,r,a)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",f="suspendedYield",h="executing",v="completed",m={};function y(){}function _(){}function b(){}var g={};c(g,o,(function(){return this}));var w=Object.getPrototypeOf,x=w&&w(w(V([])));x&&x!==r&&n.call(x,o)&&(g=x);var C=b.prototype=y.prototype=Object.create(g);function k(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(i,s,o,a){var u=d(t[i],t,s);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==E(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,o,a)}),(function(t){r("throw",t,o,a)})):e.resolve(l).then((function(t){c.value=t,o(c)}),(function(t){return r("throw",t,o,a)}))}a(u.arg)}var s;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return s=s?s.then(i,i):i()}})}function P(e,r,n){var i=p;return function(s,o){if(i===h)throw new Error("Generator is already running");if(i===v){if("throw"===s)throw o;return{value:t,done:!0}}for(n.method=s,n.arg=o;;){var a=n.delegate;if(a){var u=S(a,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var c=d(e,r,n);if("normal"===c.type){if(i=n.done?v:f,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=v,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var s=d(i,e.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,m;var o=s.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function $(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function V(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(E(e)+" is not iterable")}return _.prototype=b,i(C,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},k(j.prototype),c(j.prototype,a,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,i,s){void 0===s&&(s=Promise);var o=new j(l(t,r,n,i),s);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},k(C),c(C,u,"Generator"),c(C,o,(function(){return this})),c(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=V,$.prototype={constructor:$,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:V(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function L(t,e,r,n,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,i)}function $(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){L(s,n,i,o,a,"next",t)}function a(t){L(s,n,i,o,a,"throw",t)}o(void 0)}))}}const V={data:function(){return{order:null,name:"",selectedRegister:null,orderSubscriber:null,settingsSubscriber:null}},watch:{},methods:{__:u.__,openRegisterOptions:function(){var t=this;return $(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(t,e){Popup.show(O,{resolve:t,reject:e})}));case 3:"close_register"===e.sent.button&&(delete t.settings.register,POS.settings.next(t.settings),POS.reset()),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Object.keys(e.t0).length>0&&n.kX.error(e.t0.message).subscribe();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},registerInitialQueue:function(){var t=this;POS.initialQueue.push($(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,r){void 0===t.settings.register&&Popup.show(y,{resolve:e,reject:r})}));case 3:return r=e.sent,POS.set("register",r.data.register),t.setRegister(r.data.register),e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))))},setButtonName:function(){if(void 0===this.settings.register)return this.name=(0,u.__)("Cash Register");this.name=(0,u.__)("Cash Register : {register}").replace("{register}",this.settings.register.name)},setRegister:function(t){if(void 0!==t){var e=POS.order.getValue();e.register_id=t.id,POS.order.next(e)}}},destroyed:function(){this.orderSubscriber.unsubscribe(),this.settingsSubscriber.unsubscribe()},mounted:function(){var t=this;this.registerInitialQueue(),this.orderSubscriber=POS.order.subscribe((function(e){t.order=e})),this.settingsSubscriber=POS.settings.subscribe((function(e){t.settings=e,t.setRegister(t.settings.register),t.setButtonName()}))}};const A=(0,l.Z)(V,(function(){var t=this,e=t._self._c;return e("button",{staticClass:"flex-shrink-0 h-12 flex items-center shadow rounded px-2 py-1 text-sm bg-white text-gray-700",on:{click:function(e){return t.openRegisterOptions()}}},[e("i",{staticClass:"mr-1 text-xl las la-cash-register"}),t._v(" "),e("span",[t._v(t._s(t.name))])])}),[],!1,null,null,null).exports},5405:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var n=r(2285),i=(r(2384),r(7995)),s=r(4503);const o={name:"ns-pos-customers-button",mounted:function(){this.popupCloser()},methods:{__,popupCloser:s.Z,reset:function(){n.G.show(i.Z,{title:__("Confirm Your Action"),message:__("The current order will be cleared. But not deleted if it's persistent. Would you like to proceed ?"),onAction:function(t){t&&POS.reset()}})}}};const a=(0,r(1900).Z)(o,(function(){var t=this,e=t._self._c;return e("button",{staticClass:"flex-shrink-0 h-12 flex items-center shadow rounded px-2 py-1 text-sm bg-white text-gray-700",on:{click:function(e){return t.reset()}}},[e("i",{staticClass:"mr-1 text-xl las la-eraser"}),t._v(" "),e("span",[t._v(t._s(t.__("Reset")))])])}),[],!1,null,null,null).exports},8682:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});const n={data:function(){return{title:"",message:""}},computed:{size:function(){return this.$popupParams.size||"h-full w-full"}},mounted:function(){var t=this;this.title=this.$popupParams.title,this.message=this.$popupParams.message,this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&(void 0!==t.$popupParams.onAction&&t.$popupParams.onAction(!1),t.$popup.close())}))},methods:{__:r(9165).__,emitAction:function(t){void 0!==this.$popupParams.onAction&&this.$popupParams.onAction(t),this.$popup.close()}}};const i=(0,r(1900).Z)(n,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-6/7-screen md:w-4/7-screen lg:w-3/7-screen flex flex-col bg-white shadow-lg",class:t.size,attrs:{id:"popup"}},[e("div",{staticClass:"flex items-center justify-center flex-col flex-auto p-4"},[t.title?e("h2",{staticClass:"text-3xl font-body text-gray-700"},[t._v(t._s(t.title))]):t._e(),t._v(" "),e("p",{staticClass:"py-4 text-gray-600 text-center"},[t._v(t._s(t.message))])]),t._v(" "),e("div",{staticClass:"flex border-t border-gray-200 text-gray-700 justify-end items-center p-2"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.emitAction(!0)}}},[t._v(t._s(t.__("Ok")))])],1)])}),[],!1,null,null,null).exports},7995:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});const n={data:function(){return{title:"",message:""}},computed:{size:function(){return this.$popupParams.size||"h-full w-full"}},mounted:function(){var t=this;this.title=this.$popupParams.title,this.message=this.$popupParams.message,this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&(t.$popupParams.onAction(!1),t.$popup.close())}))},methods:{__:r(9165).__,emitAction:function(t){this.$popupParams.onAction(t),this.$popup.close()}}};const i=(0,r(1900).Z)(n,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-col bg-white shadow-lg w-5/7-screen md:w-4/7-screen lg:w-2/7-screen",class:t.size,attrs:{id:"popup"}},[e("div",{staticClass:"flex items-center justify-center flex-col flex-auto p-4"},[e("h2",{staticClass:"text-xl md:text-3xl font-body text-gray-700 text-center"},[t._v(t._s(t.title))]),t._v(" "),e("p",{staticClass:"py-4 text-sm md:text-base text-gray-600 text-center"},[t._v(t._s(t.message))])]),t._v(" "),e("div",{staticClass:"flex border-t border-gray-200 text-gray-700"},[e("button",{staticClass:"hover:bg-gray-100 flex-auto w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(e){return t.emitAction(!0)}}},[t._v(t._s(t.__("Yes")))]),t._v(" "),e("hr",{staticClass:"border-r border-gray-200"}),t._v(" "),e("button",{staticClass:"hover:bg-gray-100 flex-auto w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(e){return t.emitAction(!1)}}},[t._v(t._s(t.__("No")))])])])}),[],!1,null,null,null).exports},5140:(t,e,r)=>{"use strict";r.d(e,{Z:()=>c});var n=r(4503),i=r(4914),s=r(277),o=r(9165),a=r(7366);r(4085);const u={name:"ns-pos-coupons-load-popup",data:function(){return{placeHolder:(0,o.__)("Coupon Code"),couponCode:null,order:null,activeTab:"apply-coupon",orderSubscriber:null,customerCoupon:null}},mounted:function(){var t=this;this.popupCloser(),this.$refs.coupon.select(),this.orderSubscriber=POS.order.subscribe((function(e){t.order=e,t.order.coupons.length>0&&(t.activeTab="active-coupons")})),this.$popupParams&&this.$popupParams.apply_coupon&&(this.couponCode=this.$popupParams.apply_coupon,this.getCoupon(this.couponCode).subscribe({next:function(e){t.customerCoupon=e,t.apply()}}))},destroyed:function(){this.orderSubscriber.unsubscribe()},methods:{__:o.__,popupCloser:n.Z,popupResolver:i.Z,selectCustomer:function(){Popup.show(a.Z)},cancel:function(){this.customerCoupon=null,this.couponCode=null},removeCoupon:function(t){this.order.coupons.splice(t,1),POS.refreshCart()},apply:function(){var t=this;try{var e=this.customerCoupon;if(null!==this.customerCoupon.coupon.valid_hours_start&&!ns.date.moment.isAfter(this.customerCoupon.coupon.valid_hours_start)&&this.customerCoupon.coupon.valid_hours_start.length>0)return s.kX.error((0,o.__)("The coupon is out from validity date range.")).subscribe();if(null!==this.customerCoupon.coupon.valid_hours_end&&!ns.date.moment.isBefore(this.customerCoupon.coupon.valid_hours_end)&&this.customerCoupon.coupon.valid_hours_end.length>0)return s.kX.error((0,o.__)("The coupon is out from validity date range.")).subscribe();var r=this.customerCoupon.coupon.products;if(r.length>0){var n=r.map((function(t){return t.product_id}));if(0===this.order.products.filter((function(t){return n.includes(t.product_id)})).length)return s.kX.error((0,o.__)("This coupon requires products that aren't available on the cart at the moment.")).subscribe()}var i=this.customerCoupon.coupon.categories;if(i.length>0){var a=i.map((function(t){return t.category_id}));if(0===this.order.products.filter((function(t){return a.includes(t.$original().category_id)})).length)return s.kX.error((0,o.__)("This coupon requires products that belongs to specific categories that aren't included at the moment.").replace("%s")).subscribe()}this.cancel();var u={active:e.coupon.active,customer_coupon_id:e.id,minimum_cart_value:e.coupon.minimum_cart_value,maximum_cart_value:e.coupon.maximum_cart_value,name:e.coupon.name,type:e.coupon.type,value:0,limit_usage:e.coupon.limit_usage,code:e.coupon.code,discount_value:e.coupon.discount_value,categories:e.coupon.categories,products:e.coupon.products};POS.pushCoupon(u),this.activeTab="active-coupons",setTimeout((function(){t.popupResolver(u)}),500),s.kX.success((0,o.__)("The coupon has applied to the cart.")).subscribe()}catch(t){console.log(t)}},getCouponType:function(t){switch(t){case"percentage_discount":return(0,o.__)("Percentage");case"flat_discount":return(0,o.__)("Flat");default:return(0,o.__)("Unknown Type")}},getDiscountValue:function(t){switch(t.type){case"percentage_discount":return t.discount_value+"%";case"flat_discount":return this.$options.filters.currency(t.discount_value)}},closePopup:function(){this.popupResolver(!1)},setActiveTab:function(t){this.activeTab=t},getCoupon:function(t){return!this.order.customer_id>0?s.kX.error((0,o.__)("You must select a customer before applying a coupon.")).subscribe():s.ih.post("/api/nexopos/v4/customers/coupons/".concat(t),{customer_id:this.order.customer_id})},loadCoupon:function(){var t=this,e=this.couponCode;this.getCoupon(e).subscribe({next:function(e){t.customerCoupon=e,s.kX.success((0,o.__)("The coupon has been loaded.")).subscribe()},error:function(t){s.kX.error(t.message||(0,o.__)("An unexpected error occured.")).subscribe()}})}}};const c=(0,r(1900).Z)(u,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-lg bg-white w-95vw md:w-3/6-screen lg:w-2/6-screen"},[e("div",{staticClass:"border-b border-gray-200 p-2 flex justify-between items-center"},[e("h3",{staticClass:"font-bold text-gray-700"},[t._v(t._s(t.__("Load Coupon")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),e("div",{staticClass:"p-1"},[e("ns-tabs",{attrs:{active:t.activeTab},on:{changeTab:function(e){return t.setActiveTab(e)}}},[e("ns-tabs-item",{attrs:{label:t.__("Apply A Coupon"),padding:"p-2",identifier:"apply-coupon"}},[e("div",{staticClass:"border-2 border-blue-400 rounded flex"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],ref:"coupon",staticClass:"w-full p-2",attrs:{type:"text",placeholder:t.placeHolder},domProps:{value:t.couponCode},on:{input:function(e){e.target.composing||(t.couponCode=e.target.value)}}}),t._v(" "),e("button",{staticClass:"bg-blue-400 text-white px-3 py-2",on:{click:function(e){return t.loadCoupon()}}},[t._v(t._s(t.__("Load")))])]),t._v(" "),e("div",{staticClass:"pt-2"},[e("p",{staticClass:"p-2 text-center bg-green-100 text-green-600"},[t._v(t._s(t.__("Input the coupon code that should apply to the POS. If a coupon is issued for a customer, that customer must be selected priorly.")))])]),t._v(" "),t.order&&void 0===t.order.customer_id?e("div",{staticClass:"pt-2",on:{click:function(e){return t.selectCustomer()}}},[e("p",{staticClass:"p-2 cursor-pointer text-center bg-red-100 text-red-600"},[t._v(t._s(t.__("Click here to choose a customer.")))])]):t._e(),t._v(" "),t.order&&void 0!==t.order.customer_id?e("div",{staticClass:"pt-2"},[e("p",{staticClass:"p-2 text-center bg-green-100 text-green-600"},[t._v(t._s(t.__("Loading Coupon For : ")+"".concat(t.order.customer.name," ").concat(t.order.customer.surname)))])]):t._e(),t._v(" "),e("div",{staticClass:"overflow-hidden"},[t.customerCoupon?e("div",{staticClass:"pt-2 fade-in-entrance anim-duration-500 overflow-y-auto h-64"},[e("table",{staticClass:"w-full"},[e("thead",[e("tr",[e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.__("Coupon Name")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.customerCoupon.name))])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.__("Discount"))+" ("+t._s(t.getCouponType(t.customerCoupon.coupon.type))+")")]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.getDiscountValue(t.customerCoupon.coupon)))])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.__("Usage")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.customerCoupon.usage+"/"+(t.customerCoupon.limit_usage||t.__("Unlimited"))))])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.__("Valid From")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.customerCoupon.coupon.valid_hours_start))])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.__("Valid Till")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.customerCoupon.coupon.valid_hours_end))])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.__("Categories")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e("ul",t._l(t.customerCoupon.coupon.categories,(function(r){return e("li",{key:r.id,staticClass:"rounded-full px-3 py-1 border border-gray-200"},[t._v(t._s(r.category.name))])})),0)])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[t._v(t._s(t.__("Products")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e("ul",t._l(t.customerCoupon.coupon.products,(function(r){return e("li",{key:r.id,staticClass:"rounded-full px-3 py-1 border border-gray-200"},[t._v(t._s(r.product.name))])})),0)])])])])]):t._e()])]),t._v(" "),e("ns-tabs-item",{attrs:{label:t.__("Active Coupons"),padding:"p-1",identifier:"active-coupons"}},[t.order?e("ul",[t._l(t.order.coupons,(function(r,n){return e("li",{key:n,staticClass:"flex justify-between bg-gray-100 items-center px-2 py-1"},[e("div",{staticClass:"flex-auto"},[e("h3",{staticClass:"font-semibold text-gray-700 p-2 flex justify-between"},[e("span",[t._v(t._s(r.name))]),t._v(" "),e("span",[t._v(t._s(t.getDiscountValue(r)))])])]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.removeCoupon(n)}}})],1)])})),t._v(" "),0===t.order.coupons.length?e("li",{staticClass:"flex justify-between bg-gray-100 items-center p-2"},[t._v("\n                        No coupons applies to the cart.\n                    ")]):t._e()],2):t._e()])],1)],1),t._v(" "),t.customerCoupon?e("div",{staticClass:"flex"},[e("button",{staticClass:"w-1/2 px-3 py-2 bg-green-400 text-white font-bold",on:{click:function(e){return t.apply()}}},[t._v("\n            "+t._s(t.__("Apply"))+"\n        ")]),t._v(" "),e("button",{staticClass:"w-1/2 px-3 py-2 bg-red-400 text-white font-bold",on:{click:function(e){return t.cancel()}}},[t._v("\n            "+t._s(t.__("Cancel"))+"\n        ")])]):t._e()])}),[],!1,null,null,null).exports},7366:(t,e,r)=>{"use strict";r.d(e,{Z:()=>u});var n=r(277),i=r(4914),s=r(2285),o=r(2384);const a={data:function(){return{searchCustomerValue:"",orderSubscription:null,order:{},debounceSearch:null,customers:[],isLoading:!1}},computed:{customerSelected:function(){return!1}},watch:{searchCustomerValue:function(t){var e=this;clearTimeout(this.debounceSearch),this.debounceSearch=setTimeout((function(){e.searchCustomer(t)}),500)}},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.resolveIfQueued(!1)})),this.orderSubscription=POS.order.subscribe((function(e){t.order=e})),this.getRecentCustomers(),this.$refs.searchField.focus()},destroyed:function(){this.orderSubscription.unsubscribe()},methods:{__:r(9165).__,resolveIfQueued:i.Z,attemptToChoose:function(){if(1===this.customers.length)return this.selectCustomer(this.customers[0]);n.kX.info("Too many result.").subscribe()},openCustomerHistory:function(t,e){e.stopImmediatePropagation(),this.$popup.close(),s.G.show(o.Z,{customer:t,activeTab:"account-payment"})},selectCustomer:function(t){var e=this;this.customers.forEach((function(t){return t.selected=!1})),t.selected=!0,this.isLoading=!0,POS.selectCustomer(t).then((function(r){e.isLoading=!1,e.resolveIfQueued(t)})).catch((function(t){e.isLoading=!1}))},searchCustomer:function(t){var e=this;n.ih.post("/api/nexopos/v4/customers/search",{search:t}).subscribe((function(t){t.forEach((function(t){return t.selected=!1})),e.customers=t}))},createCustomerWithMatch:function(t){this.resolveIfQueued(!1),s.G.show(o.Z,{name:t})},getRecentCustomers:function(){var t=this;this.isLoading=!0,n.ih.get("/api/nexopos/v4/customers").subscribe((function(e){t.isLoading=!1,e.forEach((function(t){return t.selected=!1})),t.customers=e}),(function(e){t.isLoading=!1}))}}};const u=(0,r(1900).Z)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"bg-white shadow-xl w-4/5-screen md:w-2/5-screen xl:w-108"},[e("div",{staticClass:"border-b border-gray-200 text-center font-semibold text-2xl text-gray-700 py-2",attrs:{id:"header"}},[e("h2",[t._v(t._s(t.__("Select Customer")))])]),t._v(" "),e("div",{staticClass:"relative"},[e("div",{staticClass:"p-2 border-b border-gray-200 flex justify-between text-gray-600"},[e("span",[t._v("Selected : ")]),t._v(" "),e("div",{staticClass:"flex items-center justify-between"},[e("span",[t._v(t._s(t.order.customer?t.order.customer.name:"N/A"))]),t._v(" "),t.order.customer?e("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border border-gray-200 hover:bg-blue-400 hover:text-white hover:border-transparent",on:{click:function(e){return t.openCustomerHistory(t.order.customer,e)}}},[e("i",{staticClass:"las la-eye"})]):t._e()])]),t._v(" "),e("div",{staticClass:"p-2 border-b border-gray-200 flex justify-between text-gray-600"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchCustomerValue,expression:"searchCustomerValue"}],ref:"searchField",staticClass:"rounded border-2 border-blue-400 bg-gray-100 w-full p-2",attrs:{placeholder:"Search Customer",type:"text"},domProps:{value:t.searchCustomerValue},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.attemptToChoose()},input:function(e){e.target.composing||(t.searchCustomerValue=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"h-3/5-screen xl:h-2/5-screen overflow-y-auto"},[e("ul",[t.customers&&0===t.customers.length?e("li",{staticClass:"p-2 text-center text-gray-600"},[t._v("\n                    "+t._s(t.__("No customer match your query..."))+"\n                ")]):t._e(),t._v(" "),t.customers&&0===t.customers.length?e("li",{staticClass:"p-2 cursor-pointer text-center text-gray-600",on:{click:function(e){return t.createCustomerWithMatch(t.searchCustomerValue)}}},[e("span",{staticClass:"border-b border-dashed border-blue-400"},[t._v(t._s(t.__("Create a customer")))])]):t._e(),t._v(" "),t._l(t.customers,(function(r){return e("li",{key:r.id,staticClass:"cursor-pointer hover:bg-gray-100 p-2 border-b border-gray-200 text-gray-600 flex justify-between items-center",on:{click:function(e){return t.selectCustomer(r)}}},[e("span",[t._v(t._s(r.name))]),t._v(" "),e("p",{staticClass:"flex items-center"},[r.owe_amount>0?e("span",{staticClass:"text-red-600"},[t._v("-"+t._s(t._f("currency")(r.owe_amount)))]):t._e(),t._v(" "),r.owe_amount>0?e("span",[t._v("/")]):t._e(),t._v(" "),e("span",{staticClass:"text-green-600"},[t._v(t._s(t._f("currency")(r.purchases_amount)))]),t._v(" "),e("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border border-gray-200 hover:bg-blue-400 hover:text-white hover:border-transparent",on:{click:function(e){return t.openCustomerHistory(r,e)}}},[e("i",{staticClass:"las la-eye"})])])])}))],2)]),t._v(" "),t.isLoading?e("div",{staticClass:"z-10 top-0 absolute w-full h-full flex items-center justify-center"},[e("ns-spinner",{attrs:{size:"24",border:"8"}})],1):t._e()])])}),[],!1,null,null,null).exports},2384:(t,e,r)=>{"use strict";r.d(e,{Z:()=>m});var n=r(4503),i=r(277),s=r(2285),o=r(7366),a=r(40),u=r(9165);const c={mounted:function(){this.closeWithOverlayClicked(),this.loadTransactionFields()},data:function(){return{fields:[],isSubmiting:!1,formValidation:new a.Z}},methods:{__:u.__,closeWithOverlayClicked:n.Z,proceed:function(){var t=this,e=this.$popupParams.customer,r=this.formValidation.extractFields(this.fields);this.isSubmiting=!0,i.ih.post("/api/nexopos/v4/customers/".concat(e.id,"/account-history"),r).subscribe((function(e){t.isSubmiting=!1,i.kX.success(e.message).subscribe(),t.$popupParams.resolve(e),t.$popup.close()}),(function(e){t.isSubmiting=!1,i.kX.error(e.message).subscribe(),t.$popupParams.reject(e)}))},close:function(){this.$popup.close(),this.$popupParams.reject(!1)},loadTransactionFields:function(){var t=this;i.ih.get("/api/nexopos/v4/fields/ns.customers-account").subscribe((function(e){t.fields=t.formValidation.createFields(e)}))}}};var l=r(1900);const d=(0,l.Z)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-6/7-screen md:w-5/7-screen lg:w-4/7-screen h-6/7-screen md:h-5/7-screen lg:h-5/7-screen overflow-hidden shadow-lg bg-white flex flex-col relative"},[e("div",{staticClass:"p-2 border-b border-gray-200 flex justify-between items-center"},[e("h2",{staticClass:"font-semibold"},[t._v(t._s(t.__("New Transaction")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),e("div",{staticClass:"flex-auto overflow-y-auto"},[0===t.fields.length?e("div",{staticClass:"h-full w-full flex items-center justify-center"},[e("ns-spinner")],1):t._e(),t._v(" "),t.fields.length>0?e("div",{staticClass:"p-2"},t._l(t.fields,(function(t,r){return e("ns-field",{key:r,attrs:{field:t}})})),1):t._e()]),t._v(" "),e("div",{staticClass:"p-2 bg-white justify-between border-t border-gray-200 flex"},[e("div"),t._v(" "),e("div",{staticClass:"px-1"},[e("div",{staticClass:"-mx-2 flex flex-wrap"},[e("div",{staticClass:"px-1"},[e("ns-button",{attrs:{type:"danger"},on:{click:function(e){return t.close()}}},[t._v(t._s(t.__("Close")))])],1),t._v(" "),e("div",{staticClass:"px-1"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.proceed()}}},[t._v(t._s(t.__("Proceed")))])],1)])])]),t._v(" "),0===t.isSubmiting?e("div",{staticClass:"h-full w-full absolute flex items-center justify-center",staticStyle:{background:"rgb(0 98 171 / 45%)"}},[e("ns-spinner")],1):t._e()])}),[],!1,null,null,null).exports;var p=r(5140),f=r(7995),h=r(4914);const v={name:"ns-pos-customers",data:function(){return{activeTab:"create-customers",customer:null,subscription:null,orders:[],options:{},optionsSubscriber:null,selectedTab:"orders",isLoadingCoupons:!1,isLoadingRewards:!1,coupons:[],rewardsResponse:[],order:null}},components:{nsPaginate:r(1156).Z},destroyed:function(){this.subscription.unsubscribe(),this.optionsSubscriber.unsubscribe()},mounted:function(){var t=this;this.closeWithOverlayClicked(),this.optionsSubscriber=POS.options.subscribe((function(e){t.options=e})),this.subscription=POS.order.subscribe((function(e){t.order=e,void 0!==t.$popupParams.customer?(t.activeTab="account-payment",t.customer=t.$popupParams.customer,t.loadCustomerOrders(t.customer.id)):void 0!==e.customer&&(t.activeTab="account-payment",t.customer=e.customer,t.loadCustomerOrders(t.customer.id))})),this.popupCloser()},methods:{__:u.__,popupResolver:h.Z,popupCloser:n.Z,getType:function(t){switch(t){case"percentage_discount":return(0,u.__)("Percentage Discount");case"flat_discount":return(0,u.__)("Flat Discount")}},closeWithOverlayClicked:n.Z,doChangeTab:function(t){this.selectedTab=t,"coupons"===t&&this.loadCoupons(),"rewards"===t&&this.loadRewards()},loadCoupons:function(){var t=this;this.isLoadingCoupons=!0,i.ih.get("/api/nexopos/v4/customers/".concat(this.customer.id,"/coupons")).subscribe({next:function(e){t.coupons=e,t.isLoadingCoupons=!1},error:function(e){t.isLoadingCoupons=!1}})},loadRewards:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/api/nexopos/v4/customers/".concat(this.customer.id,"/rewards");this.isLoadingRewards=!0,i.ih.get(e).subscribe({next:function(e){t.rewardsResponse=e,t.isLoadingRewards=!1},error:function(e){t.isLoadingRewards=!1}})},allowedForPayment:function(t){return["unpaid","partially_paid","hold"].includes(t.payment_status)},prefillForm:function(t){void 0!==this.$popupParams.name&&(t.main.value=this.$popupParams.name)},openCustomerSelection:function(){this.$popup.close(),s.G.show(o.Z)},loadCustomerOrders:function(t){var e=this;i.ih.get("/api/nexopos/v4/customers/".concat(t,"/orders")).subscribe((function(t){e.orders=t}))},newTransaction:function(t){new Promise((function(e,r){s.G.show(d,{customer:t,resolve:e,reject:r})})).then((function(e){POS.loadCustomer(t.id).subscribe((function(t){POS.selectCustomer(t)}))}))},applyCoupon:function(t){var e=this;void 0===this.order.customer?s.G.show(f.Z,{title:(0,u.__)("Use Customer ?"),message:(0,u.__)("No customer is selected. Would you like to proceed with this customer ?"),onAction:function(r){r&&POS.selectCustomer(e.customer).then((function(r){e.proceedApplyingCoupon(t)}))}}):this.order.customer.id===this.customer.id?this.proceedApplyingCoupon(t):this.order.customer.id!==this.customer.id&&s.G.show(f.Z,{title:(0,u.__)("Change Customer ?"),message:(0,u.__)("Would you like to assign this customer to the ongoing order ?"),onAction:function(r){r&&POS.selectCustomer(e.customer).then((function(r){e.proceedApplyingCoupon(t)}))}})},proceedApplyingCoupon:function(t){var e=this;new Promise((function(e,r){s.G.show(p.Z,{apply_coupon:t.code,resolve:e,reject:r})})).then((function(t){e.popupResolver(!1)})).catch((function(t){}))},handleSavedCustomer:function(t){i.kX.success(t.message).subscribe(),POS.selectCustomer(t.entry),this.$popup.close()}}};const m=(0,l.Z)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"bg-white shadow-lg rounded w-95vw h-95vh lg:w-3/5-screen flex flex-col overflow-hidden"},[e("div",{staticClass:"p-2 flex justify-between items-center border-b border-gray-400"},[e("h3",{staticClass:"font-semibold text-gray-700"},[t._v(t._s(t.__("Customers")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.$popup.close()}}})],1)]),t._v(" "),e("div",{staticClass:"flex-auto flex p-2 bg-gray-200 overflow-y-auto"},[e("ns-tabs",{attrs:{active:t.activeTab},on:{active:function(e){t.activeTab=e}}},[e("ns-tabs-item",{attrs:{identifier:"create-customers",label:"New Customer"}},["yes"===t.options.ns_pos_customers_creation_enabled?e("ns-crud-form",{attrs:{"submit-url":"/api/nexopos/v4/crud/ns.customers",src:"/api/nexopos/v4/crud/ns.customers/form-config"},on:{updated:function(e){return t.prefillForm(e)},save:function(e){return t.handleSavedCustomer(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[t._v(t._s(t.__("Customer Name")))]},proxy:!0},{key:"save",fn:function(){return[t._v(t._s(t.__("Save Customer")))]},proxy:!0}],null,!1,2432171054)}):t._e(),t._v(" "),e("div",{staticClass:"h-full flex-col w-full flex items-center justify-center"},[e("i",{staticClass:"lar la-hand-paper text-6xl text-gray-700"}),t._v(" "),e("h3",{staticClass:"font-medium text-2xl text-gray-700"},[t._v(t._s(t.__("Not Authorized")))]),t._v(" "),e("p",{staticClass:"text-gray-600"},[t._v(t._s(t.__("Creating customers has been explicitly disabled from the settings.")))])])],1),t._v(" "),e("ns-tabs-item",{staticClass:"flex",staticStyle:{padding:"0!important"},attrs:{identifier:"account-payment",label:t.__("Customer Account")}},[null===t.customer?e("div",{staticClass:"flex-auto w-full flex items-center justify-center flex-col p-4"},[e("i",{staticClass:"lar la-frown text-6xl text-gray-700"}),t._v(" "),e("h3",{staticClass:"font-medium text-2xl text-gray-700"},[t._v(t._s(t.__("No Customer Selected")))]),t._v(" "),e("p",{staticClass:"text-gray-600"},[t._v(t._s(t.__("In order to see a customer account, you need to select one customer.")))]),t._v(" "),e("div",{staticClass:"my-2"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.openCustomerSelection()}}},[t._v(t._s(t.__("Select Customer")))])],1)]):t._e(),t._v(" "),t.customer?e("div",{staticClass:"flex flex-col flex-auto"},[e("div",{staticClass:"flex-auto p-2 flex flex-col"},[e("div",{staticClass:"-mx-4 flex flex-wrap"},[e("div",{staticClass:"px-4 mb-4 w-full"},[e("h2",{staticClass:"font-semibold text-gray-700"},[t._v(t._s(t.__("Summary For"))+" : "+t._s(t.customer.name))])]),t._v(" "),e("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[e("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-green-400 to-green-700 p-2 flex flex-col text-white"},[e("h3",{staticClass:"font-medium text-lg"},[t._v(t._s(t.__("Total Purchases")))]),t._v(" "),e("div",{staticClass:"w-full flex justify-end"},[e("h2",{staticClass:"text-2xl font-bold"},[t._v(t._s(t._f("currency")(t.customer.purchases_amount)))])])])]),t._v(" "),e("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[e("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-red-500 to-red-700 p-2 text-white"},[e("h3",{staticClass:"font-medium text-lg"},[t._v(t._s(t.__("Total Owed")))]),t._v(" "),e("div",{staticClass:"w-full flex justify-end"},[e("h2",{staticClass:"text-2xl font-bold"},[t._v(t._s(t._f("currency")(t.customer.owed_amount)))])])])]),t._v(" "),e("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[e("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-blue-500 to-blue-700 p-2 text-white"},[e("h3",{staticClass:"font-medium text-lg"},[t._v(t._s(t.__("Account Amount")))]),t._v(" "),e("div",{staticClass:"w-full flex justify-end"},[e("h2",{staticClass:"text-2xl font-bold"},[t._v(t._s(t._f("currency")(t.customer.account_amount)))])])])]),t._v(" "),e("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[e("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-teal-500 to-teal-700 p-2 text-white"},[e("h3",{staticClass:"font-medium text-lg"},[t._v(t._s(t.__("Credit Limit")))]),t._v(" "),e("div",{staticClass:"w-full flex justify-end"},[e("h2",{staticClass:"text-2xl font-bold"},[t._v(t._s(t._f("currency")(t.customer.credit_limit_amount)))])])])])]),t._v(" "),e("div",{staticClass:"flex flex-auto flex-col overflow-hidden"},[e("ns-tabs",{attrs:{active:t.selectedTab},on:{changeTab:function(e){return t.doChangeTab(e)}}},[e("ns-tabs-item",{attrs:{identifier:"orders",label:t.__("Orders")}},[e("div",{staticClass:"py-2 w-full"},[e("h2",{staticClass:"font-semibold text-gray-700"},[t._v(t._s(t.__("Last Purchases")))])]),t._v(" "),e("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[e("div",{staticClass:"flex-auto overflow-y-auto"},[e("table",{staticClass:"table w-full"},[e("thead",[e("tr",{staticClass:"text-gray-700"},[e("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold",attrs:{width:"150"}},[t._v(t._s(t.__("Order")))]),t._v(" "),e("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"},[t._v(t._s(t.__("Total")))]),t._v(" "),e("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"},[t._v(t._s(t.__("Status")))]),t._v(" "),e("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold",attrs:{width:"50"}},[t._v(t._s(t.__("Options")))])])]),t._v(" "),e("tbody",{staticClass:"text-gray-700"},[0===t.orders.length?e("tr",[e("td",{staticClass:"border border-gray-200 p-2 text-center",attrs:{colspan:"4"}},[t._v(t._s(t.__("No orders...")))])]):t._e(),t._v(" "),t._l(t.orders,(function(r){return e("tr",{key:r.id},[e("td",{staticClass:"border border-gray-200 p-2 text-center"},[t._v(t._s(r.code))]),t._v(" "),e("td",{staticClass:"border border-gray-200 p-2 text-center"},[t._v(t._s(t._f("currency")(r.total)))]),t._v(" "),e("td",{staticClass:"border border-gray-200 p-2 text-right"},[t._v(t._s(r.human_status))]),t._v(" "),e("td",{staticClass:"border border-gray-200 p-2 text-center"},[t.allowedForPayment(r)?e("button",{staticClass:"hover:bg-blue-400 hover:border-transparent hover:text-white rounded-full h-8 px-2 flex items-center justify-center border border-gray bg-white"},[e("i",{staticClass:"las la-wallet"}),t._v(" "),e("span",{staticClass:"ml-1"},[t._v(t._s(t.__("Payment")))])]):t._e()])])}))],2)])])])]),t._v(" "),e("ns-tabs-item",{attrs:{identifier:"coupons",label:t.__("Coupons")}},[t.isLoadingCoupons?e("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[e("ns-spinner",{attrs:{size:"36"}})],1):t._e(),t._v(" "),t.isLoadingCoupons?t._e():[e("div",{staticClass:"py-2 w-full"},[e("h2",{staticClass:"font-semibold text-gray-700"},[t._v(t._s(t.__("Coupons")))])]),t._v(" "),e("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[e("div",{staticClass:"flex-auto overflow-y-auto"},[e("table",{staticClass:"table w-full"},[e("thead",[e("tr",{staticClass:"text-gray-700"},[e("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold",attrs:{width:"150"}},[t._v(t._s(t.__("Name")))]),t._v(" "),e("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"},[t._v(t._s(t.__("Type")))]),t._v(" "),e("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"})])]),t._v(" "),e("tbody",{staticClass:"text-gray-700 text-sm"},[0===t.coupons.length?e("tr",[e("td",{staticClass:"border border-gray-200 p-2 text-center",attrs:{colspan:"4"}},[t._v(t._s(t.__("No coupons for the selected customer...")))])]):t._e(),t._v(" "),t._l(t.coupons,(function(r){return e("tr",{key:r.id},[e("td",{staticClass:"border border-gray-200 p-2",attrs:{width:"300"}},[e("h3",[t._v(t._s(r.name))]),t._v(" "),e("div",{},[e("ul",{staticClass:"-mx-2 flex"},[e("li",{staticClass:"text-xs text-gray-600 px-2"},[t._v(t._s(t.__("Usage :"))+" "+t._s(r.usage)+"/"+t._s(r.limit_usage))]),t._v(" "),e("li",{staticClass:"text-xs text-gray-600 px-2"},[t._v(t._s(t.__("Code :"))+" "+t._s(r.code))])])])]),t._v(" "),e("td",{staticClass:"border border-gray-200 p-2 text-center"},[t._v(t._s(t.getType(r.coupon.type))+" \n                                                                "),"percentage_discount"===r.coupon.type?e("span",[t._v("\n                                                                    ("+t._s(r.coupon.discount_value)+"%)\n                                                                ")]):t._e(),t._v(" "),"flat_discount"===r.coupon.type?e("span",[t._v("\n                                                                    ("+t._s(t._f("currency")(r.coupon.discount_value))+")\n                                                                ")]):t._e()]),t._v(" "),e("td",{staticClass:"border border-gray-200 p-2 text-right"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.applyCoupon(r)}}},[t._v(t._s(t.__("Use Coupon")))])],1)])}))],2)])])])]],2),t._v(" "),e("ns-tabs-item",{attrs:{identifier:"rewards",label:t.__("Rewards")}},[t.isLoadingRewards?e("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[e("ns-spinner",{attrs:{size:"36"}})],1):t._e(),t._v(" "),t.isLoadingRewards?t._e():[e("div",{staticClass:"py-2 w-full"},[e("h2",{staticClass:"font-semibold text-gray-700"},[t._v(t._s(t.__("Rewards")))])]),t._v(" "),e("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[e("div",{staticClass:"flex-auto overflow-y-auto"},[e("table",{staticClass:"table w-full"},[e("thead",[e("tr",{staticClass:"text-gray-700"},[e("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold",attrs:{width:"150"}},[t._v(t._s(t.__("Name")))]),t._v(" "),e("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"},[t._v(t._s(t.__("Points")))]),t._v(" "),e("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"},[t._v(t._s(t.__("Target")))])])]),t._v(" "),t.rewardsResponse.data?e("tbody",{staticClass:"text-gray-700 text-sm"},[0===t.rewardsResponse.data.length?e("tr",[e("td",{staticClass:"border border-gray-200 p-2 text-center",attrs:{colspan:"4"}},[t._v(t._s(t.__("No rewards available the selected customer...")))])]):t._e(),t._v(" "),t._l(t.rewardsResponse.data,(function(r){return e("tr",{key:r.id},[e("td",{staticClass:"border border-gray-200 p-2",attrs:{width:"300"}},[e("h3",{staticClass:"text-center"},[t._v(t._s(r.reward_name))])]),t._v(" "),e("td",{staticClass:"border border-gray-200 p-2",attrs:{width:"300"}},[e("h3",{staticClass:"text-center"},[t._v(t._s(r.points))])]),t._v(" "),e("td",{staticClass:"border border-gray-200 p-2",attrs:{width:"300"}},[e("h3",{staticClass:"text-center"},[t._v(t._s(r.target))])])])}))],2):t._e()])])]),t._v(" "),e("div",{staticClass:"py-1 flex justify-end"},[e("ns-paginate",{attrs:{pagination:t.rewardsResponse},on:{load:function(e){return t.loadRewards(e)}}})],1)]],2)],1)],1)]),t._v(" "),e("div",{staticClass:"p-2 border-t border-gray-400 flex justify-between"},[e("div"),t._v(" "),e("div",[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.newTransaction(t.customer)}}},[t._v(t._s(t.__("Account Transaction")))])],1)])]):t._e()])],1)],1)])}),[],!1,null,null,null).exports},3866:(t,e,r)=>{"use strict";r.d(e,{Z:()=>d});var n=r(40),i=r(277),s=r(9165);function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){var n;return n=function(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==c(n)?n:String(n))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}const l={name:"ns-pos-layaway-popup",data:function(){return{fields:[],instalments:[],formValidation:new n.Z,subscription:null,totalPayments:0}},mounted:function(){var t=this;this.loadFields(),this.subscription=this.$popup.event.subscribe((function(e){["click-overlay","press-esc"].includes(e.event)&&t.close()}))},updated:function(){var t=this;setTimeout((function(){document.querySelector(".is-popup #total_instalments").addEventListener("change",(function(){var e=t.formValidation.extractFields(t.fields).total_instalments;t.generatePaymentFields(e)})),document.querySelector(".is-popup #total_instalments").addEventListener("focus",(function(){document.querySelector(".is-popup #total_instalments").select()}))}),200)},computed:{expectedPayment:function(){var t=this.order.customer.group.minimal_credit_payment;return nsRawCurrency(this.order.total*t/100)},order:function(){return this.$popupParams.order.instalments=this.$popupParams.order.instalments.map((function(t){for(var e in t)if("object"!==c(t[e]))if("date"===e){var r={type:"date",name:e,label:(0,s.__)("Date"),disabled:1===t.paid,value:moment(t.date).format("YYYY-MM-DD")};t[e]=r}else if("amount"===e){var n={type:"number",name:e,label:(0,s.__)("Amount"),disabled:1===t.paid,value:t.amount};t[e]=n}else if(!["paid","id"].includes(e)){var i={type:"hidden",name:e,value:t[e]};t[e]=i}return t})),this.$popupParams.order}},destroyed:function(){this.subscription.unsubscribe()},methods:{__:s.__,refreshTotalPayments:function(){if(this.order.instalments.length>0){var t=nsRawCurrency(this.order.instalments.map((function(t){return parseFloat(t.amount.value)||0})).reduce((function(t,e){return parseFloat(t)+parseFloat(e)})));this.totalPayments=this.order.total-t}else this.totalPayments=0},generatePaymentFields:function(t){var e=this;this.order.instalments=new Array(parseInt(t)).fill("").map((function(t,r){return{date:{type:"date",name:"date",label:"Date",value:0===r?ns.date.moment.format("YYYY-MM-DD"):""},amount:{type:"number",name:"amount",label:"Amount",value:0===r?e.expectedPayment:0},readonly:{type:"hidden",name:"readonly",value:e.expectedPayment>0&&0===r}}})),this.$forceUpdate(),this.refreshTotalPayments()},close:function(){this.$popupParams.reject({status:"failed",message:(0,s.__)("You must define layaway settings before proceeding.")}),this.$popup.close()},updateOrder:function(){var t=this;if(0===this.order.instalments.length)return i.kX.error((0,s.__)("Please provide instalments before proceeding.")).subscribe();if(this.fields.forEach((function(e){return t.formValidation.validateField(e)})),!this.formValidation.fieldsValid(this.fields))return i.kX.error((0,s.__)("Unable to procee the form is not valid")).subscribe();this.$forceUpdate();var e=this.order.instalments.map((function(t){return{amount:parseFloat(t.amount.value),date:t.date.value}})),r=nsRawCurrency(e.map((function(t){return t.amount})).reduce((function(t,e){return parseFloat(t)+parseFloat(e)})));if(e.filter((function(t){return void 0===t.date||""===t.date})).length>0)return i.kX.error((0,s.__)("One or more instalments has an invalid date.")).subscribe();if(e.filter((function(t){return!(t.amount>0)})).length>0)return i.kX.error((0,s.__)("One or more instalments has an invalid amount.")).subscribe();if(e.filter((function(t){return moment(t.date).isBefore(ns.date.moment.startOf("day"))})).length>0)return i.kX.error((0,s.__)("One or more instalments has a date prior to the current date.")).subscribe();var n=e.filter((function(t){return moment(t.date).isSame(ns.date.moment.startOf("day"),"day")})),o=0;if(n.forEach((function(t){o+=parseFloat(t.amount)})),o<this.expectedPayment)return i.kX.error((0,s.__)("The payment to be made today is less than what is expected.")).subscribe();if(r<nsRawCurrency(this.order.total))return i.kX.error((0,s.__)("Total instalments must be equal to the order total.")).subscribe();e.sort((function(t,e){var r=moment(t.date),n=moment(e.date);return r.isBefore(n)?-1:r.isAfter(n)?1:0}));var u=this.formValidation.extractFields(this.fields);u.final_payment_date=e.reverse()[0].date,u.total_instalments=e.length;var c=a(a(a({},this.$popupParams.order),u),{},{instalments:e}),l=this.$popupParams,d=l.resolve;l.reject;return this.$popup.close(),POS.order.next(c),d(c)},loadFields:function(){var t=this;i.ih.get("/api/nexopos/v4/fields/ns.layaway").subscribe((function(e){t.fields=t.formValidation.createFields(e),t.fields.forEach((function(e){"total_instalments"===e.name&&(e.value=t.order.total_instalments||0)}))}))}}};const d=(0,r(1900).Z)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-lg h-95vh md:h-5/6-screen lg:h-5/6-screen w-95vw md:w-4/6-screen lg:w-3/6-screen bg-white flex flex-col"},[e("div",{staticClass:"p-2 border-b flex justify-between items-center"},[e("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("Layaway Parameters")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),e("div",{staticClass:"p-2 flex-auto flex flex-col relative overflow-y-auto"},[0===t.fields.length?e("div",{staticClass:"absolute h-full w-full flex items-center justify-center"},[e("ns-spinner")],1):t._e(),t._v(" "),e("div",{staticClass:"p-2 text-white bg-blue-400 mb-2 text-center text-2xl font-bold flex justify-between"},[e("span",[t._v(t._s(t.__("Minimum Payment")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.expectedPayment)))])]),t._v(" "),e("div",t._l(t.fields,(function(t,r){return e("ns-field",{key:r,attrs:{field:t}})})),1),t._v(" "),e("div",{staticClass:"flex flex-col flex-auto overflow-hidden"},[e("div",{staticClass:"border-b border-gray-200"},[e("h3",{staticClass:"text-2xl flex justify-between py-2 text-gray-700"},[e("span",[t._v(t._s(t.__("Instalments & Payments")))]),t._v(" "),e("p",[e("span",{staticClass:"text-sm"},[t._v("("+t._s(t._f("currency")(t.totalPayments))+")")]),t._v(" "),e("span",[t._v("\n                        "+t._s(t._f("currency")(t.order.total))+"\n                        ")])])]),t._v(" "),e("p",{staticClass:"p-2 mb-2 text-center bg-green-200 text-green-700"},[t._v("\n                    "+t._s(t.__("The final payment date must be the last within the instalments."))+"\n                ")])]),t._v(" "),e("div",{staticClass:"flex-auto overflow-y-auto"},[t._l(t.order.instalments,(function(r,n){return e("div",{key:n,staticClass:"flex w-full -mx-1 py-2"},[e("div",{staticClass:"flex flex-auto"},[e("div",{staticClass:"px-1 w-full md:w-1/2"},[e("ns-field",{attrs:{field:r.date},on:{change:function(e){return t.refreshTotalPayments()}}})],1),t._v(" "),e("div",{staticClass:"px-1 w-full md:w-1/2"},[e("ns-field",{attrs:{field:r.amount},on:{change:function(e){return t.refreshTotalPayments()}}})],1)]),t._v(" "),t._m(0,!0)])})),t._v(" "),0===t.order.instalments.length?e("div",{staticClass:"my-2"},[e("p",{staticClass:"p-2 bg-gray-200 text-gray-700 text-center"},[t._v(t._s(t.__("There is not instalment defined. Please set how many instalments are allowed for this order")))])]):t._e()],2)])]),t._v(" "),e("div",{staticClass:"p-2 flex border-t justify-between flex-shrink-0"},[e("div"),t._v(" "),e("div",{staticClass:"-mx-1 flex"},[e("div",{staticClass:"px-1"},[e("ns-button",{attrs:{type:"danger"},on:{click:function(e){return t.close()}}},[t._v(t._s(t.__("Cancel")))])],1),t._v(" "),e("div",{staticClass:"px-1"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.updateOrder()}}},[t._v(t._s(t.__("Proceed")))])],1)])])])}),[function(){var t=this._self._c;return t("div",{staticClass:"flex items-center"},[t("button",{staticClass:"items-center flex justify-center h-8 w-8 rounded border border-gray-200 hover:bg-red-400 hover:border-red-400 hover:text-white"},[t("i",{staticClass:"las la-times"})])])}],!1,null,null,null).exports},8674:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});const n={name:"ns-pos-loading-popup"};const i=(0,r(1900).Z)(n,(function(){return(0,this._self._c)("ns-spinner")}),[],!1,null,null,null).exports},8997:(t,e,r)=>{"use strict";r.d(e,{Z:()=>u});var n=r(4914);r(1294);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function d(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,s=Object.create(i.prototype),a=new $(n||[]);return o(s,"_invoke",{value:O(t,r,a)}),s}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var h="suspendedStart",v="suspendedYield",m="executing",y="completed",_={};function b(){}function g(){}function w(){}var x={};d(x,u,(function(){return this}));var C=Object.getPrototypeOf,k=C&&C(C(V([])));k&&k!==r&&n.call(k,u)&&(x=k);var j=w.prototype=b.prototype=Object.create(x);function P(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(s,o,a,u){var c=f(t[s],t,o);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==i(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(d).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var s;o(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return s=s?s.then(i,i):i()}})}function O(e,r,n){var i=h;return function(s,o){if(i===m)throw new Error("Generator is already running");if(i===y){if("throw"===s)throw o;return{value:t,done:!0}}for(n.method=s,n.arg=o;;){var a=n.delegate;if(a){var u=E(a,n);if(u){if(u===_)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=m;var c=f(e,r,n);if("normal"===c.type){if(i=n.done?y:v,c.arg===_)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=y,n.method="throw",n.arg=c.arg)}}}function E(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var s=f(i,e.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,_;var o=s.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,_):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function $(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function V(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function r(){for(;++s<e.length;)if(n.call(e,s))return r.value=e[s],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(i(e)+" is not iterable")}return g.prototype=w,o(j,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=d(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,d(t,l,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},P(S.prototype),d(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,i,s){void 0===s&&(s=Promise);var o=new S(p(t,r,n,i),s);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},P(j),d(j,l,"Generator"),d(j,u,(function(){return this})),d(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=V,$.prototype={constructor:$,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,_):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),_},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),_}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:V(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),_}},e}function o(t,e,r,n,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,i)}const a={data:function(){return{types:[],typeSubscription:null}},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.resolveIfQueued(!1)})),this.typeSubscription=POS.types.subscribe((function(e){t.types=e,1===Object.values(t.types).length&&t.select(Object.keys(t.types)[0])}))},destroyed:function(){this.typeSubscription.unsubscribe()},methods:{__:r(9165).__,resolveIfQueued:n.Z,select:function(t){var e,r=this;return(e=s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object.values(r.types).forEach((function(t){return t.selected=!1})),r.types[t].selected=!0,n=r.types[t],e.prev=3,e.next=6,POS.triggerOrderTypeSelection(n);case 6:e.sent,POS.types.next(r.types),r.resolveIfQueued(n),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(3);case 13:case"end":return e.stop()}}),e,null,[[3,11]])})),function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function a(t){o(s,n,i,a,u,"next",t)}function u(t){o(s,n,i,a,u,"throw",t)}a(void 0)}))})()}}};const u=(0,r(1900).Z)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"h-full w-4/5-screen md:w-2/5-screen lg:w-2/5-screen xl:w-2/6-screen bg-white shadow-lg"},[e("div",{staticClass:"h-16 flex justify-center items-center",attrs:{id:"header"}},[e("h3",{staticClass:"font-bold text-gray-700"},[t._v(t._s(t.__("Define The Order Type")))])]),t._v(" "),0===Object.values(t.types).length?e("div",{staticClass:"grid grid-flow-row grid-cols-1 grid-rows-1"},[e("div",{staticClass:"h-full w-full flex items-center justify-center flex-col"},[e("i",{staticClass:"las la-frown text-7xl text-red-400"}),t._v(" "),e("div",{staticClass:"p-4 md:w-2/3"},[e("p",{staticClass:"text-center text-gray-600"},[t._v(t._s(t.__("No payment type has been selected on the settings. Please check your POS features and choose the supported order type")))]),t._v(" "),e("div",{staticClass:"flex justify-center py-1"},[e("ns-link",{attrs:{target:"_blank",type:"info",href:"https://my.nexopos.com/en/documentation/components/order-types"}},[t._v(t._s(t.__("Read More")))])],1)])])]):t._e(),t._v(" "),Object.values(t.types).length>0?e("div",{staticClass:"grid grid-flow-row grid-cols-2 grid-rows-2"},t._l(t.types,(function(r){return e("div",{key:r.identifier,staticClass:"hover:bg-blue-100 h-56 flex items-center justify-center flex-col cursor-pointer border border-gray-200",class:r.selected?"bg-blue-100":"",on:{click:function(e){return t.select(r.identifier)}}},[e("img",{staticClass:"w-32 h-32",attrs:{src:r.icon,alt:""}}),t._v(" "),e("h4",{staticClass:"font-semibold text-xl my-2 text-gray-700"},[t._v(t._s(r.label))])])})),0):t._e()])}),[],!1,null,null,null).exports},1836:(t,e,r)=>{"use strict";r.d(e,{Z:()=>u});var n=r(277),i=r(9165);function s(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}const a={data:function(){return{finalValue:1,virtualStock:null,allSelected:!0,isLoading:!1,keys:[].concat(s([1,2,3].map((function(t){return{identifier:t,value:t}}))),s([4,5,6].map((function(t){return{identifier:t,value:t}}))),s([7,8,9].map((function(t){return{identifier:t,value:t}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&(t.$popupParams.reject(!1),t.$popup.close())})),this.$popupParams.product.quantity&&(this.finalValue=this.$popupParams.product.quantity),document.addEventListener("keyup",this.handleKeyPress)},destroyed:function(){document.removeEventListener("keypress",this.handleKeyPress)},methods:{__:i.__,handleKeyPress:function(t){13===t.keyCode&&this.inputValue({identifier:"next"})},inputValue:function(t){if("next"===t.identifier){var e=this.$popupParams,r=e.product,s=e.data,o=parseFloat(this.finalValue);if(0===o)return n.kX.error((0,i.__)("Please provide a quantity")).subscribe();if("enabled"===r.$original().stock_management){var a=POS.getStockUsage(r.$original().id,s.unit_quantity_id)-(r.quantity||0);if(o>parseFloat(s.$quantities().quantity)-a)return n.kX.error((0,i.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",s.$quantities().quantity-a)).subscribe()}this.resolve({quantity:o})}else"backspace"===t.identifier?this.allSelected?(this.finalValue=0,this.allSelected=!1):(this.finalValue=this.finalValue.toString(),this.finalValue=this.finalValue.substr(0,this.finalValue.length-1)||0):this.allSelected?(this.finalValue=t.value,this.finalValue=parseFloat(this.finalValue),this.allSelected=!1):(this.finalValue+=""+t.value,this.finalValue=parseFloat(this.finalValue))},resolve:function(t){this.$popupParams.resolve(t),this.$popup.close()}}};const u=(0,r(1900).Z)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"bg-white shadow min-h-2/5-screen w-3/4-screen md:w-3/5-screen lg:w-2/5-screen xl:w-2/5-screen relative"},[t.isLoading?e("div",{staticClass:"flex w-full h-full absolute top-O left-0 items-center justify-center",staticStyle:{background:"rgb(202 202 202 / 49%)"},attrs:{id:"loading-overlay"}},[e("ns-spinner")],1):t._e(),t._v(" "),e("div",{staticClass:"flex-shrink-0 py-2 border-b border-gray-200"},[e("h1",{staticClass:"text-xl font-bold text-gray-700 text-center"},[t._v(t._s(t.__("Define Quantity")))])]),t._v(" "),e("div",{staticClass:"h-16 border-b bg-gray-800 text-white border-gray-200 flex items-center justify-center",attrs:{id:"screen"}},[e("h1",{staticClass:"font-bold text-3xl"},[t._v(t._s(t.finalValue))])]),t._v(" "),e("div",{staticClass:"grid grid-flow-row grid-cols-3 grid-rows-3",attrs:{id:"numpad"}},t._l(t.keys,(function(r,n){return e("div",{key:n,staticClass:"hover:bg-blue-400 hover:text-white hover:border-blue-600 text-xl font-bold border border-gray-200 h-24 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.inputValue(r)}}},[void 0!==r.value?e("span",[t._v(t._s(r.value))]):t._e(),t._v(" "),r.icon?e("i",{staticClass:"las",class:r.icon}):t._e()])})),0)])}),[],!1,null,null,null).exports},1294:(t,e,r)=>{"use strict";r.d(e,{Z:()=>d});var n=r(277),i=r(4914),s=r(40);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){var n;return n=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==o(n)?n:String(n))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const l={name:"ns-pos-shipping-popup",computed:{activeTabFields:function(){if(null!==this.tabs)for(var t in this.tabs)if(this.tabs[t].active)return this.tabs[t].fields;return[]},useBillingInfo:function(){return null!==this.tabs?this.tabs.billing.fields[0].value:new Object},useShippingInfo:function(){return null!==this.tabs?this.tabs.shipping.fields[0].value:new Object}},destroyed:function(){this.orderSubscription.unsubscribe()},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.resolveIfQueued(!1)})),this.orderSubscription=POS.order.subscribe((function(e){return t.order=e})),this.loadForm()},data:function(){return{tabs:null,orderSubscription:null,order:null,formValidation:new s.Z}},watch:{useBillingInfo:function(t){var e=this;1===t&&this.tabs.billing.fields.forEach((function(t){"_use_customer_billing"!==t.name&&(t.value=e.order.customer.billing?e.order.customer.billing[t.name]:t.value)}))},useShippingInfo:function(t){var e=this;1===t&&this.tabs.shipping.fields.forEach((function(t){"_use_customer_shipping"!==t.name&&(t.value=e.order.customer.shipping?e.order.customer.shipping[t.name]:t.value)}))}},methods:{__,resolveIfQueued:i.Z,submitInformations:function(){var t=this.formValidation.extractForm({tabs:this.tabs});for(var e in t.general)["shipping","shipping_rate"].includes(e)&&(t.general[e]=parseFloat(t.general[e]));this.order=u(u({},this.order),t.general),delete t.general,delete t.shipping._use_customer_shipping,delete t.billing._use_customer_billing,this.order.addresses=t,POS.order.next(this.order),POS.refreshCart(),this.resolveIfQueued(!0)},closePopup:function(){this.resolveIfQueued(!1)},toggle:function(t){for(var e in this.tabs)this.tabs[e].active=!1;this.tabs[t].active=!0},loadForm:function(){var t=this;n.ih.get("/api/nexopos/v4/forms/ns.pos-addresses").subscribe((function(e){var r=e.tabs,n=function(e){"general"===e?r[e].fields.forEach((function(e){e.value=t.order[e.name]||""})):r[e].fields.forEach((function(r){r.value=t.order.addresses[e]?t.order.addresses[e][r.name]:""}))};for(var i in r)n(i);t.tabs=t.formValidation.initializeTabs(r)}))}}};const d=(0,r(1900).Z)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"bg-white w-6/7-screen md:w-4/5-screen lg:w-3/5-screen h-6/7-screen md:h-4/5-screen shadow-lg flex flex-col overflow-hidden"},[e("div",{staticClass:"p-2 border-b border-gray-200 flex justify-between items-center"},[e("h3",{staticClass:"font-bold text-gray-700"},[t._v(t._s(t.__("Shipping & Billing")))]),t._v(" "),e("div",{staticClass:"tools"},[e("button",{staticClass:"hover:bg-red-400 hover:text-white hover:border-red-600 rounded-full h-8 w-8 border items-center justify-center",on:{click:function(e){return t.closePopup()}}},[e("i",{staticClass:"las la-times"})])])]),t._v(" "),e("div",{staticClass:"flex-auto bg-gray-200 p-4 overflow-y-auto"},[e("div",{staticClass:"my-5",attrs:{id:"tabs-container"}},[e("div",{staticClass:"header flex",staticStyle:{"margin-bottom":"-1px"}},t._l(t.tabs,(function(r,n){return e("div",{key:n,staticClass:"tab rounded-tl rounded-tr border border-gray-400 px-3 py-2 text-gray-700 cursor-pointer",class:r.active?"border-b-0 bg-white":"border bg-gray-200",staticStyle:{"margin-right":"-1px"},on:{click:function(e){return t.toggle(n)}}},[t._v(t._s(r.label))])})),0),t._v(" "),e("div",{staticClass:"border border-gray-400 p-4 bg-white"},[e("div",{staticClass:"-mx-4 flex flex-wrap"},t._l(t.activeTabFields,(function(r,n){return e("div",{key:n,class:"px-4 w-full md:w-1/2 lg:w-1/3"},[e("ns-field",{attrs:{field:r},on:{blur:function(e){return t.formValidation.checkField(r)},change:function(e){return t.formValidation.checkField(r)}}})],1)})),0)])])]),t._v(" "),e("div",{staticClass:"p-2 flex justify-between border-t border-gray-300"},[e("div"),t._v(" "),e("div",[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.submitInformations()}}},[t._v(t._s(t.__("Save")))])],1)])])}),[],!1,null,null,null).exports},149:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});const n={data:function(){return{title:"",message:"",input:""}},computed:{size:function(){return this.$popupParams.size||"h-full w-full"}},mounted:function(){var t=this;this.input=this.$popupParams.input||"",this.title=this.$popupParams.title,this.message=this.$popupParams.message,this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&(t.$popupParams.reject(!1),t.$popup.close())}))},methods:{__:r(9165).__,emitAction:function(t){this.$popupParams.onAction(t?this.input:t),this.$popup.close()},reject:function(t){void 0!==this.$popupParams.reject&&this.$popupParams.reject(t),this.$popup.close()}}};const i=(0,r(1900).Z)(n,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-5/7-screen md:w-3/7-screen flex flex-col bg-white shadow-lg",class:t.size,attrs:{id:"popup"}},[e("div",{staticClass:"flex items-center justify-center flex-col flex-auto p-2"},[e("h2",{staticClass:"text-3xl font-body text-gray-700"},[t._v(t._s(t.title))]),t._v(" "),e("p",{staticClass:"w-full md:mx-auto md:w-2/3 py-4 text-gray-600 text-center"},[t._v(t._s(t.message))])]),t._v(" "),e("div",{staticClass:"p-2"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],staticClass:"text-gray-700 w-full border-2 p-2 border-blue-400",attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:t.input},on:{input:function(e){e.target.composing||(t.input=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"flex border-t border-gray-200 text-gray-700"},[e("button",{staticClass:"hover:bg-gray-100 flex-auto w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(e){return t.emitAction(!0)}}},[t._v(t._s(t.__("Ok")))]),t._v(" "),e("hr",{staticClass:"border-r border-gray-200"}),t._v(" "),e("button",{staticClass:"hover:bg-gray-100 flex-auto w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(e){return t.reject(!1)}}},[t._v(t._s(t.__("Cancel")))])])])}),[],!1,null,null,null).exports}},t=>{t.O(0,[898],(()=>{return e=811,t(t.s=e);var e}));t.O()}]);
//# sourceMappingURL=pos-init.min.js.map